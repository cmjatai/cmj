"use strict";(self["webpackChunkPortalCMJ_Frontend_v2018"]=self["webpackChunkPortalCMJ_Frontend_v2018"]||[]).push([[4686],{4686:function(e,t,s){s.r(t),s.d(t,{default:function(){return k}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container-fluid container-arqtree"},[t("div",{staticClass:"row"},[t("div",{attrs:{id:"col-classes"}},[t("div",{staticClass:"arqtree-inner"},[t("div",{staticClass:"arqtree-titulo"},[t("span",{staticClass:"collapse-all",on:{click:e.clickCollapseAll}},[t("i",{staticClass:"fas fa-chevron-left"}),t("i",{staticClass:"fas fa-chevron-left"})]),t("h1",[e._v("ArqView")])]),t("node-layout",{ref:"noderoot",attrs:{level:0}})],1)]),t("div",{attrs:{id:"col-docs"}},[t("router-view",{key:e.$route.fullPath,ref:"selectednode",on:{checkIsOpenedNodesTree:e.checkIsOpenedNodesTree}})],1)])])},a=[],n=(s(4114),s(3110),s(8335),function(){var e=this,t=e._self._c;return t("div",{class:["node-element",null!==e.node&&0===e.node.count_childs?"type-content":"",null!==e.node&&e.node.id===parseInt(e.nodechild_params)?"active":""]},[e.node?t("div",{class:["node-titulo",`level-${e.level}`]},[t("span",{staticClass:"spacer"}),0!==e.node.count_childs?t("span",{staticClass:"toggle",on:{click:e.clickToggle}},[e.is_opened&&e.childs?e._e():t("i",{staticClass:"fas fa-chevron-right"}),e.is_opened&&e.childs?t("i",{staticClass:"fas fa-chevron-down"}):e._e()]):e._e(),t("span",{staticClass:"content"},[t("router-link",{attrs:{to:{name:"arqchildroute",params:{node:e.node_params,nodechild:e.node.id}}},nativeOn:{click:function(t){return e.clickRoute.apply(null,arguments)}}},[e._v(" "+e._s(e.node.titulo)+" "),e.node.checkcheck?t("i",{staticClass:"fas fa-xs fa-lock text-light-blue",attrs:{title:"ArqClasse Arquivada."}}):e._e()]),t("div",{staticClass:"btn-group btn-group-sm el-actions"},[t("a",{staticClass:"btn btn-link",attrs:{href:`/arqadmin/classe/${e.node.id}`,target:"_blank"}},[t("i",{staticClass:"fas fa-edit"})]),t("a",{staticClass:"btn btn-link",attrs:{href:`/arq/${e.node.id}/${e.node.id}`}},[t("i",{staticClass:"fas fa-expand"})])]),t("small",{staticClass:"box-descricao",domProps:{innerHTML:e._s(e.descricao_html)}})],1)]):e._e(),e._l(e.childs,function(s,o){return t("node-layout",{key:`class-${o}`,attrs:{elemento:s,parent:e.elemento,level:e.level+1}})})],2)}),l=[],r=s(2543),i={name:"node-layout",props:["parent","elemento","level"],data(){return{childs:{},is_opened:!1,node_params:this.$route.params.node,nodechild_params:this.$route.params.nodechild,node:null,node_key_localstorage:"portalcmj_arqnode_tree_opened",click_title:!1,ARQCLASSE_FISICA:100,ARQCLASSE_LOGICA:200}},mounted(){this.reload()},computed:{descricao_html:function(){let e=this.node.descricao;return e=e.replace("\r\n","<br>"),e=e.replace("\n","<br>"),`<strong>${this.node.conta}</strong> - <strong>${this.node.titulo}</strong><br><i>${e}</i>`}},watch:{is_opened:function(e,t){e?(this.fetch(1,`&get_all=True&parent=${this.node.id}`),localStorage.addArrayOfIds(this.node_key_localstorage,this.node.id)):(this.$set(this,"childs",{}),r.isEmpty(this.node)||localStorage.delItemArrayOfIds(this.node_key_localstorage,this.node.id))},$route:function(e,t){const s=this;s.node_params=e.params.node,s.nodechild_params=e.params.nodechild,s.$nextTick().then(function(){s.openIfInArrayOfIds()})}},methods:{clickRoute(){this.clickToggle()},clickToggle(){this.is_opened=!this.is_opened},openIfInArrayOfIds(){r.isEmpty(this.node)||this.is_opened||!localStorage.inArrayOfIds(this.node_key_localstorage,this.node.id)||(this.is_opened=!0,this.fetch(1,`&get_all=True&parent=${this.node.id}`))},reload(){const e=this;e.node=e.elemento||null,"root"===e.node_params&&void 0===e.elemento?e.fetch(1,"&get_all=True&parent__isnull=True"):void 0===this.elemento?e.fetchElemento(e.node_params).then(()=>{e.fetch(1,`&get_all=True&parent=${e.node_params}`).then(()=>{e.clickToggle()})}):e.openIfInArrayOfIds()},fetch(e=1,t=""){const s=this;return s.$set(s,"childs",{}),s.utils.getModelOrderedList("arq","arqclasse","titulo",e,t).then(e=>{r.each(e.data,function(e,t){s.$set(s.childs,e.id,e)})}).catch(e=>s.sendMessage({alert:"danger",message:"Não foi possível recuperar os sub itens...",time:5}))},fetchElemento(e){const t=this;return t.utils.getModel("arq","arqclasse",e).then(e=>(t.node=e.data,e)).catch(e=>t.sendMessage({alert:"danger",message:"Não foi possível recuperar node...",time:5}))}}},d=i,c=s(1656),h=(0,c.A)(d,n,l,!1,null,null,null),p=h.exports,u=s(7291),_=s(2543),f={name:"admin-layout",components:{NodeLayout:p},data(){return{node_key_localstorage:"portalcmj_arqnode_tree_opened",check_opened:0}},watch:{$route:function(e,t){"arqchildroute"===e.name&&e.params.node!==t.params.node&&(this.$refs.noderoot.node_params=e.params.node,this.$refs.noderoot.nodechild_params=e.params.nodechild,this.$refs.noderoot.reload())}},methods:{checkIsOpenedNodesTree(){this.check_opened+=1},clickCollapseAll(){if(this.$refs.noderoot.is_opened)localStorage.clearArrayOfIds(this.node_key_localstorage),this.$refs.noderoot.is_opened=!1;else{const e=this.$refs.noderoot.node;let t="";t=null!==e&&null!==e.parent?e.parent:"root";let s=this.$refs.selectednode;if(_.isEmpty(s)||_.isEmpty(s.classe)||null==s.classe.parent)if(!_.isEmpty(e)&&e.id!==t||void 0!==this.$route.params.nodechild){let e="arqadminroute",s={node:t};"root"!==t&&(s["nodechild"]=t,e="arqchildroute"),this.$router.push({name:e,params:s})}else localStorage.clearArrayOfIds(this.node_key_localstorage),this.$refs.noderoot.reload(),this.sendMessage({alert:"danger",message:"Topo atingido!",time:2});else{let e="arqchildroute",o={node:t,nodechild:s.classe.parent};localStorage.delItemArrayOfIds(this.node_key_localstorage,s.classe.parent),this.$router.push({name:e,params:o})}}}},mounted(){let e=localStorage.getItem("split-sizes");e?(e=JSON.parse(e),e[0]+e[1]>100&&(e=[35,65])):e=[35,65],(0,u.A)(["#col-classes","#col-docs"],{minSize:350,sizes:e,onDragEnd:function(e){localStorage.setItem("split-sizes",JSON.stringify(e))}})}},m=f,g=(0,c.A)(m,o,a,!1,null,null,null),k=g.exports}}]);