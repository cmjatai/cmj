"use strict";(self["webpackChunkportalcmj_frontend"]=self["webpackChunkportalcmj_frontend"]||[]).push([[7355],{7355:function(t,e,a){a.r(e),a.d(e,{default:function(){return K}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"sessao-plenaria-online"},[t.sessao?[e("sessao-plenaria-topo",{attrs:{sessao:t.sessao}}),e("pauta-online",{attrs:{sessao:t.sessao}})]:t._e()],2)},i=[],o=(a(4114),function(){var t=this,e=t._self._c;return e("div",{class:"sessao-plenaria-topo"},[e("div",{staticClass:"tit"},[t._v(" "+t._s(t.titulo)+" ")]),e("div",{staticClass:"subtitulo"},[e("span",[t._v(t._s(t.subtitulo))]),t._v(" – "),e("span",[t._v(t._s(t.date_text))])])])}),n=[],r=a(2543),l={name:"sessao-plenaria-topo",props:["sessao"],data(){return{app:["sessao","parlamentares"],model:["sessaoplenaria","sessaolegislativa","tiposessaoplenaria","legislatura"],data_inicio:new Date,sessao_legislativa:{numero:""},tipo:{nome:""},legislatura:{numero:""},metadata:{sessao_legislativa:{app:"parlamentares",model:"sessaolegislativa",id:this.sessao.sessao_legislativa},legislatura:{app:"parlamentares",model:"legislatura",id:this.sessao.legislatura},tipo:{app:"sessao",model:"tiposessaoplenaria",id:this.sessao.tipo}}}},watch:{sessao:function(t){this.updateSessao(),this.fetch()}},computed:{titulo:function(){let t=this.sessao,e=this.tipo,a=this.data_inicio;return`${t.numero}ª ${e.nome} da\n              ${a.getDate()>15?2:1}ª Quinzena do Mês de\n              ${this.month_text(a.getMonth())} de\n              ${a.getFullYear()}\n              `},subtitulo:function(){return`${this.sessao_legislativa.numero}ª Sessão Legislativa da\n              ${this.legislatura.numero}ª Legislatura`},date_text:function(){return`${this.data_inicio.getDate()} de\n              ${this.month_text(this.data_inicio.getMonth())} de\n              ${this.data_inicio.getFullYear()} – ${this.sessao.hora_inicio}`}},methods:{fetch(t){let e=this;r.mapKeys(e.metadata,function(t,a){let s=e.metadata[a];e.getObject(s).then(t=>{e[a]=t})})},updateSessao(){this.data_inicio=this.stringToDate(this.sessao.data_inicio,"yyyy-mm-dd","-"),this.metadata.sessao_legislativa.id=this.sessao.sessao_legislativa,this.metadata.tipo.id=this.sessao.tipo,this.metadata.legislatura.id=this.sessao.legislatura}},mounted:function(){this.updateSessao(),this.fetch()}},d=l,c=a(1656),m=(0,c.A)(d,o,n,!1,null,null,null),p=m.exports,u=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pauta-online"},[0===t.itens.ordemdia_list.length&&t.init?e("div",{staticClass:"empty-list"},[t._v(" Não existem Itens na Ordem do Dia com seus critérios de busca! ")]):t._e(),t.init?t._e():e("div",{staticClass:"empty-list"},[t._v(" Carregando listagem... ")]),e("div",{class:["item-expediente",t.nivel(t.NIVEL3,t.itens.expedientesessao_list.length>0)]},[e("div",{staticClass:"inner",domProps:{innerHTML:t._s(t.expediente(1))}})]),e("div",{staticClass:"container-expedientemateria"},[t.itensDoExpediente.length?e("div",{staticClass:"titulo-container"},[t._v("Matérias do Grande Expediente")]):t._e(),e("div",{staticClass:"inner"},t._l(t.itensDoExpediente,function(t){return e("item-de-pauta",{key:`exp${t.id}`,attrs:{item:t,type:"expedientemateria"}})}),1)]),e("div",{class:["item-expediente",t.nivel(t.NIVEL3,t.itens.expedientesessao_list.length>0)]},[e("div",{staticClass:"inner",domProps:{innerHTML:t._s(t.expediente(3))}})]),e("div",{staticClass:"container-ordemdia"},[t.itensDaOrdemDia.length?e("div",{staticClass:"titulo-container"},[t._v("Matérias da Ordem do Dia")]):t._e(),e("div",{staticClass:"inner"},t._l(t.itensDaOrdemDia,function(t){return e("item-de-pauta",{key:`od${t.id}`,attrs:{item:t,type:"ordemdia"}})}),1)]),e("div",{class:["item-expediente",t.nivel(t.NIVEL3,t.itens.expedientesessao_list.length>0)]},[e("div",{staticClass:"inner",domProps:{innerHTML:t._s(t.expediente(4))}})])])},v=[],h=(a(8111),a(2489),function(){var t=this,e=t._self._c;return e("div",{class:["item-de-pauta",t.type]},[e("div",{class:["empty-list",void 0===t.materia.id?"":"d-none"]},[t._v(" Carregando Matéria... ")]),t.votacaoAberta&&t.user&&t.user.votante?e("voto-parlamentar",{attrs:{item:t.item,type:t.type}}):t._e(),e("div",{staticClass:"status-votacao"},[t.registro&&!t.votacaoAberta&&4!=t.item.tipo_votacao?e("div",{staticClass:"votos"},[t.registro.numero_abstencoes?e("div",{staticClass:"voto-abs"},[e("span",{staticClass:"valor"},[t._v(t._s(t.registro.numero_abstencoes))]),e("span",{staticClass:"titulo"},[t._v("ABS")])]):t._e(),e("div",{staticClass:"voto-nao"},[e("span",{staticClass:"valor"},[t._v(t._s(t.registro.numero_votos_nao))]),e("span",{staticClass:"titulo"},[t._v("NÃO")])]),e("div",{staticClass:"voto-sim"},[e("span",{staticClass:"valor"},[t._v(t._s(t.registro.numero_votos_sim))]),e("span",{staticClass:"titulo"},[t._v("SIM")])])]):t._e(),e("div",{class:[t.statusVotacao]},[t.votacaoPedidoPrazoAberta?e("span",[t._v("VOTAÇÃO ABERTA PARA PEDIDO DE ADIAMENTO")]):t.votacaoAberta?e("span",[t._v("VOTAÇÃO ABERTA")]):t.item.resultado?e("span",[t._v(t._s(t.item.resultado))]):e("span",[t._v("Tramitando")])])]),e("materia-pauta",{attrs:{materia:t.materia,type:t.type}}),e("div",{class:["item-body"]}),e("div",{class:["item-body",void 0!==t.materia.id&&t.materia.anexadas.length>0?"col-anexadas":""]},[e("div",{staticClass:"col-1-body"},[e("div",{staticClass:"status-tramitacao"},[e("div",{class:["observacao",t.nivel(t.NIVEL3,t.observacao.length>0)],domProps:{innerHTML:t._s(t.observacao)}})]),e("div",{class:["sub-containers",0===t.itensLegislacaoCitada.length?"d-none":"container-legis-citada"]},[t._m(0),e("div",{staticClass:"inner"},t._l(t.itensLegislacaoCitada,function(a){return e("button",{key:`legiscit${a.id}`,staticClass:"btn btn-link",attrs:{type:"button","data-toggle":"modal","data-target":`modal-legis-citada-${a.id}`},on:{click:function(e){t.modal_legis_citada=a}}},[t._v(" "+t._s(a.__str__)+" ")])}),0)]),e("div",{class:["sub-containers",t.nivel(t.NIVEL2,t.itensDocumentosAcessorios.length>0),0===t.itensDocumentosAcessorios.length?"d-none":"container-docs-acessorios"]},[t._m(1),e("div",{staticClass:"inner"},t._l(t.itensDocumentosAcessorios,function(a){return e("a",{key:`docsacc${a.id}`,staticClass:"btn btn-link",attrs:{href:a.arquivo}},[t._v(" "+t._s(a.__str__)+" ")])}),0)])]),e("div",{staticClass:"col-2-body"},[e("div",{class:["sub-containers",t.nivel(t.NIVEL1,t.itensAnexados.length>0)]},[t._m(2),e("div",{staticClass:"inner"},t._l(t.itensAnexados,function(a){return e("div",{key:`${t.type}${a.id}`},[e("materia-pauta",{attrs:{materia:a,type:t.type}})],1)}),0)])])]),t.modal_legis_citada?e("norma-simple-modal-view",{attrs:{html_id:`modal-legis-citada-${t.modal_legis_citada.id}`,modal_norma:null,idd:t.modal_legis_citada.norma}}):t._e()],1)}),_=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"title"},[e("span",[t._v(" Legislação Citada ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"title"},[e("span",[t._v(" Documentos Acessórios ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"title"},[e("span",[t._v(" Matérias Anexadas em Tramitação")])])}],g=function(){var t=this,e=t._self._c;return e("div",{class:["materia-pauta"],attrs:{id:`mp${t.type}-${t.materia.id}`}},[e("a",{staticClass:"epigrafe",attrs:{href:t.materia.link_detail_backend,target:"_blank"}},[t._v(t._s(t.tipo_string)+" nº "+t._s(t.materia.numero)+"/"+t._s(t.materia.ano))]),e("div",{class:["item-header",t.tipo_string?"":"d-none"]},[e("div",{key:`${t.type}-${t.materia.id}`,staticClass:"link-file",attrs:{id:`${t.type}-${t.materia.id}`}},[e("a",{class:["btn btn-link",`link-file-${t.materia.id}`,t.blob?"":"d-none"],on:{click:t.clickFile}},[e("i",{staticClass:"far fa-2x fa-file-pdf"})]),e("small",{class:t.baixando?"":"d-none"},[t._v("Baixando"),e("br"),t._v("Arquivo")]),e("a",{class:["btn btn-link",`link-file-${t.materia.id}`],attrs:{href:t.materia.texto_original,target:"_blank"}},[e("i",{staticClass:"far fa-2x fa-file-pdf"})]),e("hr"),e("div",{key:`pp-${t.type}-${t.materia.id}`,staticClass:"page-preview",attrs:{id:`pp-${t.type}-${t.materia.id}`}},[e("div",{staticClass:"btn btn-preview",on:{click:t.togglePreview}},[e("i",{class:["fas fa-eye",t.preview?"d-block":"d-none"]}),e("i",{class:["far fa-eye-slash",t.preview?"d-none":"d-block"]})]),e("div",{class:["preview-online",t.preview?"d-block":"d-none"],attrs:{id:`pon-${t.materia.id}`}},[e("span",{staticClass:"p-5"},[t._v(" Carregando imagem da primeira página da matéria... ")]),e("div",{staticClass:"preview-direction"},[e("div",{staticClass:"inner-direction btn-group"},[e("span",{directives:[{name:"show",rawName:"v-show",value:t.materia._paginas>1,expression:"materia._paginas > 1"}],staticClass:"btn btn-secondary preview-previous",on:{click:function(e){return t.changePage(-1)}}},[t._m(0)]),e("div",{staticClass:"preview-currentpage"},[t._m(1),e("div",[e("span",{staticClass:"currentpage"},[t._v(t._s(t.preview_page))]),t._v(" de "),e("span",{staticClass:"totalpage"},[t._v(t._s(t.materia._paginas))])])]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.materia._paginas>1,expression:"materia._paginas > 1"}],staticClass:"btn btn-secondary preview-next",on:{click:function(e){return t.changePage(1)}}},[t._m(2)])])]),e("div",{staticClass:"btn btn-danger",on:{click:t.togglePreview}},[t._v("X")]),e("img",{staticClass:"img-fluid",attrs:{loading:"lazy",src:`${t.materia.texto_original}?page=${t.preview_page}&dpi=190&u=${t.utimes}`,title:"",alt:"Preview da Primeira Página do Documento..."}}),t.preview_loading?e("div",{staticClass:"loading"},[e("div",{staticClass:"loader"})]):t._e()])])]),e("div",{staticClass:"data-header"},[e("div",{staticClass:"detail-header"},[e("div",{staticClass:"protocolo-data"},[e("span",[t._v(" Protocolo: "),e("strong",[t._v(t._s(t.materia.numero_protocolo))])]),e("span",[t._v(t._s(t.data_apresentacao))])]),e("div",{staticClass:"autoria"},t._l(t.autores_list,function(a,s){return e("span",{key:`au${s}`},[t._v(t._s(a.nome))])}),0)]),e("div",{staticClass:"ementa",domProps:{innerHTML:t._s(t.materia.ementa)}}),e("div",{staticClass:"status-tramitacao"},[e("div",{class:["ultima_tramitacao",t.nivel(t.NIVEL2,null!==t.tramitacao.ultima)]},[e("strong",[t._v("Situação:")]),t._v(" "+t._s(t.tramitacao.status.descricao)),e("br"),e("strong",[t._v("Ultima Ação:")]),t._v(" "+t._s(t.tramitacao.ultima.texto)+" ")])])])])])},f=[function(){var t=this,e=t._self._c;return e("i",{staticClass:"fas fa-chevron-left",attrs:{"aria-hidden":"true"}},[e("span",[t._v("Página Anterior")])])},function(){var t=this,e=t._self._c;return e("small",[e("em",[t._v("Página Atual")])])},function(){var t=this,e=t._self._c;return e("i",{staticClass:"fas fa-chevron-right",attrs:{"aria-hidden":"true"}},[e("span",[t._v("Próxima Página")])])}],b=(a(4603),a(7566),a(8721),a(2543)),$={name:"materia-pauta",props:["materia","type"],data(){return{app:["materia"],model:["materialegislativa","tramitacao","anexada","autoria"],autores:{},tramitacao:{ultima:{},status:{}},tipo_string:"",blob:null,baixando:!1,preview:!1,preview_page:1,preview_loading:!1,paginas_abertas:[],utimes:0}},watch:{materia:function(t){const e=this;e.refresh()}},computed:{data_apresentacao(){try{const t=this.stringToDate(this.materia.data_apresentacao,"yyyy-mm-dd","-");return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}catch(t){return""}},autores_list:{get(){return b.orderBy(this.autores,"nome")}}},mounted(){const t=this;t.blob||void 0===t.materia.id||t.refresh(),t.$root.$on("closePreviews",e=>{t.materia.id!==e&&(t.preview=!1)})},methods:{changePage(t){const e=this;e.preview_page+t>0&&e.preview_page+t<=e.materia._paginas&&(e.preview_page+=t,e.utimes++,e.preview_page>1&&!e.paginas_abertas.includes(e.preview_page)&&(e.preview_loading=!0,setTimeout(()=>{e.preview_loading=!1,e.paginas_abertas.push(e.preview_page)},3e3)))},togglePreview(){const t=this;t.preview=!t.preview,t.preview_loading=t.preview,setTimeout(()=>{t.preview_loading=!1},1e3),t.preview&&(t.$root.$emit("closePreviews",t.materia.id),setTimeout(()=>{const e=document.getElementById(`mp${t.type}-${t.materia.id}`),a=document.getElementsByClassName("main")[0];let s=0,i=e;do{s+=i.offsetTop,i=i.offsetParent}while(i&&"BODY"!==i.tagName);a.scrollTo({top:s-120,behavior:"smooth"})},1e3))},fetchUltimaTramitacao(){const t=this;return t.utils.getByMetadata({action:"ultima_tramitacao",app:"materia",model:"materialegislativa",id:t.materia.id}).then(e=>{t.tramitacao.ultima=e.data,void 0!==t.tramitacao.ultima.id&&t.getObject({action:"",app:"materia",model:"statustramitacao",id:t.tramitacao.ultima.status}).then(e=>{t.tramitacao.status=e})})},clickFile(t){const e=window.URL.createObjectURL(this.blob);window.location=e},fetch(t){const e=this;void 0!==e.materia&&e.materia.id===t.id&&t.model===e.model[0]&&this.refresh()},refresh(){const t=this;void 0!==t.materia&&void 0!==t.materia.id&&(t.getObject({app:"materia",model:"tipomaterialegislativa",id:t.materia.tipo}).then(e=>{t.tipo_string=e.descricao}),t.$set(t,"autores",{}),t.$nextTick().then(()=>{b.each(t.materia.autores,e=>{t.getObject({app:"base",model:"autor",id:e}).then(e=>{t.$set(t.autores,e.id,e),t.fetchUltimaTramitacao()})})}))}}},x=$,C=(0,c.A)(x,g,f,!1,null,null,null),y=C.exports,w=function(){var t=this,e=t._self._c;return e("div",{class:["voto-parlamentar"]},[e("div",{staticClass:"inner-voto"},[e("a",{staticClass:"btn btn-lg btn-success",attrs:{href:"#"},on:{click:function(e){return t.sendVoto("Sim")}}},[t._v("SIM")]),e("a",{staticClass:"btn btn-lg btn-danger",attrs:{href:"#"},on:{click:function(e){return t.sendVoto("Não")}}},[t._v("NÃO")]),e("a",{staticClass:"btn btn-lg btn-warning",attrs:{href:"#"},on:{click:function(e){return t.sendVoto("Abstenção")}}},[t._v("Abstenção")])]),e("div",{staticClass:"voto-result"},[t.voto?e("div",[t._v(" Voto Computado: "),e("strong",[t._v(t._s(t.voto.voto))])]):e("div",[t._v(" Voto não Computado ")])])])},k=[],A={name:"voto-parlamentar",props:["item","type"],components:{},data(){return{app:["sessao"],model:["votoparlamentar"],itens:{votoparlamentar_list:{}}}},watch:{},computed:{voto(){const t=this,e="ordemdia"===t.type?"ordem":"expediente",a=Object.values(t.itens.votoparlamentar_list).filter(a=>a.parlamentar===t.user.votante.parlamentar_id&&a[e]===t.item.id);return a.length>0?a[0]:null}},mounted(){this.refresh()},methods:{refresh(){const t=this;t.fetchModelOrderedList("sessao","votoparlamentar","",1,"&"+("ordemdia"===t.type?"ordem":"expediente")+"="+t.item.id)},fetch(t){if("post_delete"!==t.action){if("sessao"===t.app&&"votoparlamentar"===t.model){const e=this;e.getObject(t).then(a=>{a.ordem!==e.item.id&&a.expediente!==e.item.id||e.$set(e.itens[`${t.model}_list`],t.id,a)})}}else this.$delete(this.itens[`${t.model}_list`],t.id)},sendVoto(t){const e=this,a="ordemdia"===e.type?"ordem":"expediente",s={parlamentar:e.user.votante.parlamentar_id,voto:t,user:e.user.id,[a]:e.item.id};e.voto?this.utils.patchModel("sessao","votoparlamentar",e.voto.id,s).then(t=>{}).catch(t=>{}):this.utils.postModel("sessao","votoparlamentar",s).then(t=>{}).catch(t=>{})}}},D=A,M=(0,c.A)(D,w,k,!1,null,null,null),T=M.exports,P=a(6264),L=a(4692),V=a(2543),O={name:"item-de-pauta",props:["item","type"],components:{MateriaPauta:y,VotoParlamentar:T,NormaSimpleModalView:P.A},data(){return{app:["materia","norma","sessao"],model:["materialegislativa","tramitacao","anexada","autoria","legislacaocitada","documentoacessorio","registrovotacao","registroleitura","votoparlamentar"],materia:{},tramitacao:{ultima:{},status:{}},anexadas:{},legislacaocitada:{},documentoacessorio:{},modal_legis_citada:null,registro:null}},watch:{modal_legis_citada:function(t,e){const a=this;null!==t&&this.$nextTick().then(()=>{L(`#modal-legis-citada-${t.id}`).modal("show"),L(`#modal-legis-citada-${t.id}`).on("hidden.bs.modal",function(t){a.modal_legis_citada=null})})},item:function(t,e){this.$nextTick().then(()=>{this.registro=null}).then(()=>{this.fetchRegistroDeVoto()})}},computed:{data_apresentacao(){try{const t=this.stringToDate(this.materia.data_apresentacao,"yyyy-mm-dd","-");return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`}catch(t){return""}},observacao(){let t=this.item.observacao;return t=t.replace(/^\r\n/g,""),t=t.replace(/\r\n/g,"<br />"),t=t.replace(/\r/g," "),t=t.replace(/\n/g,"<br />"),t},itensAnexados:{get(){return V.orderBy(this.anexadas,["-tipo","data_apresentacao","id"])}},itensLegislacaoCitada:{get(){return V.orderBy(this.legislacaocitada,"norma")}},itensDocumentosAcessorios:{get(){return V.orderBy(this.documentoacessorio,"data")}},votacaoAberta:{get(){return this.item.votacao_aberta&&this.item.tipo_votacao<=2}},votacaoPedidoPrazoAberta:{get(){return this.item.votacao_aberta_pedido_prazo&&this.item.tipo_votacao<=2}},statusVotacao:{get(){let t="",e=this.item.resultado;return this.votacaoAberta?t="votacao-aberta":"Aprovado"===e?t="result-aprovado":"Rejeitado"===e?t="result-rejeitado":"Pedido de Vista"===e?t="result-vista":"Prazo Regimental"===e&&(t="result-prazo"),t}}},mounted(){this.refresh()},methods:{refresh(){const t=this;t.fetchMateria().then(e=>{V.each(t.materia.anexadas,(e,a)=>{t.fetchMateria({action:"post_save",app:t.app[0],model:t.model[0],id:e})})}),t.$nextTick().then(()=>{}).then(()=>{t.fetchLegislacaoCitada()}).then(()=>{t.fetchDocumentoAcessorio()}).then(()=>{t.fetchRegistroDeVoto()})},fetch(t){const e=this;void 0!==t&&("materia"===t.app&&"materialegislativa"===t.model?(t.id===e.item.materia||t.id in e.materia.anexadas)&&e.fetchMateria(t):"materia"===t.app&&"anexada"===t.model?(e.$set(e,"anexadas",{}),e.refreshState({action:"",app:e.app[0],model:e.model[0],id:e.item.materia}).then(t=>{e.refresh()})):"materia"===t.app&&"autoria"===t.model?e.refreshState({action:"",app:e.app[0],model:e.model[0],id:e.item.materia}).then(t=>{e.refresh()}):"materia"===t.app&&"tramitacao"===t.model?e.fetchUltimaTramitacao(t):"norma"===t.app&&"legislacaocitada"===t.model?e.fetchLegislacaoCitada():"materia"===t.app&&"documentoacessorio"===t.model?e.fetchDocumentoAcessorio():"sessao"===t.app&&["registrovotacao","registroleitura","votoparlamentar"].includes(t.model)&&e.fetchRegistroDeVoto(t))},async fetchRegistroDeVoto(t){const e=this,a=4===e.item.tipo_votacao?"registroleitura":"registrovotacao",s="expedientemateria"===e.type?"expediente":"ordem";if(e.item.resultado.length>0&&null===e.registro){const t=`&${s}=${e.item.id}&o=-id`;e.utils.getModelList("sessao",a,1,t).then(t=>{V.each(t.data.results.slice(0,1),t=>{e.registro=t,e.refreshState({app:"sessao",model:a,value:t,id:t.id})})}).catch(t=>{e.sendMessage({alert:"danger",message:"Não foi possível recuperar o Registro de Votos/Leitura.",time:5})})}e.nulls.includes(t)||e.nulls.includes(e.registro)||e.registro.id!==t.id||e.getObject(t).then(t=>{e.nulls.includes(t)?e.registro=null:t.materia===e.item.materia&&(e.registro=t)})},fetchDocumentoAcessorio(t=1){const e=this,a=`&materia=${e.item.materia}`;e.utils.getModelList("materia","documentoacessorio",t,a).then(t=>{V.each(t.data.results,t=>{e.$set(e.documentoacessorio,t.id,t)}),null!==t.data.pagination.next_page&&e.$nextTick().then(function(){e.fetchDocumentoAcessorio(t.data.pagination.next_page)})}).catch(t=>{e.sendMessage({alert:"danger",message:"Não foi possível recuperar a lista de Documentos Acessórios.",time:5})})},fetchLegislacaoCitada(t=1){const e=this,a=`&materia=${e.item.materia}`;e.utils.getModelList("norma","legislacaocitada",t,a).then(t=>{V.each(t.data.results,t=>{e.$set(e.legislacaocitada,t.id,t)}),null!==t.data.pagination.next_page&&e.$nextTick().then(function(){e.fetchLegislacaoCitada(t.data.pagination.next_page)})}).catch(t=>{e.sendMessage({alert:"danger",message:"Não foi possível recuperar a lista de Legislação Citada.",time:5})})},fetchMateria(t){const e=this;return e.getObject({action:"",app:e.app[0],model:e.model[0],id:void 0!==t?t.id:e.item.materia}).then(t=>(t.id===e.item.materia?e.materia=t:e.$set(e.anexadas,t.id,t),t))},fetchUltimaTramitacao(){const t=this;return t.utils.getByMetadata({action:"ultima_tramitacao",app:"materia",model:"materialegislativa",id:t.item.materia}).then(e=>{t.tramitacao.ultima=e.data,void 0!==t.tramitacao.ultima.id&&t.getObject({action:"",app:"materia",model:"statustramitacao",id:t.tramitacao.ultima.status}).then(e=>{t.tramitacao.status=e})})}}},N=O,S=(0,c.A)(N,h,_,!1,null,null,null),E=S.exports,j=a(2543),I={name:"pauta-online",props:["sessao"],components:{ItemDePauta:E},data(){return{itens:{expedientesessao_list:[],ordemdia_list:{},expedientemateria_list:{}},init:!1,app:["sessao"],model:["expedientemateria","ordemdia"]}},computed:{itensDaOrdemDia:{get(){return j.orderBy(j.filter(this.itens.ordemdia_list,t=>null===t.parent),"numero_ordem")}},itensDoExpediente:{get(){return j.orderBy(this.itens.expedientemateria_list,"numero_ordem")}}},mounted(){setTimeout(()=>{this.fetchItens(),this.fetchExpedienteSessao()},1e3)},methods:{expediente(t){const e=this.itens.expedientesessao_list;let a=j.filter(e,["tipo",t]);return a.length>0?a[0].conteudo:""},fetch(t){if("post_delete"===t.action)return void this.$delete(this.itens[`${t.model}_list`],t.id);const e=this;e.getObject(t).then(a=>{if(a.sessao_plenaria===e.sessao.id&&null===a.parent){const s=e.itens[`${t.model}_list`],i=t.id;e.$nextTick().then(function(){e.$set(s,i,a)})}"post_save"===t.action&&t.created&&(t.app="materia",t.model="materialegislativa",t.id=a.materia,e.getObject(t).then(t=>{e.sendMessage({alert:"info",message:`<strong>${t.__str__} adicionado a esta sessão.</strong><br><i>${t.ementa}</i>`,time:25})}))})},fetchItens(t=this.model){const e=this;j.mapKeys(t,function(t,a){j.mapKeys(e.itens[`${t}_list`],function(t,e){t.vue_validate=!1}),e.$nextTick().then(function(){e.fetchList(1,t)})})},fetchExpedienteSessao(){const t=this;return t.utils.getByMetadata({action:"expedientes",app:"sessao",model:"sessaoplenaria",id:t.sessao.id}).then(e=>{t.$set(t.itens,"expedientesessao_list",e.data.results)}).then(t=>{})},fetchList(t=null,e=null){const a=this;let s=`&sessao_plenaria=${this.sessao.id}`;a.utils.getModelOrderedList("sessao",e,"numero_ordem",null===t?1:t,s).then(t=>{a.init=!0,j.each(t.data.results,(t,s)=>{t.vue_validate=!0,t.id in a.itens[`${e}_list`]?a.itens[`${e}_list`][t.id]=t:a.$set(a.itens[`${e}_list`],t.id,t)}),a.$nextTick().then(function(){null!==t.data.pagination.next_page?a.fetchList(t.data.pagination.next_page,e):j.mapKeys(a.itens[`${e}_list`],function(t,s){t.vue_validate||a.$delete(a.itens[`${e}_list`],t.id)})})}).catch(t=>{a.init=!0,a.sendMessage({alert:"danger",message:"Não foi possível recuperar a Ordem do Dia.",time:5})})}}},B=I,R=(0,c.A)(B,u,v,!1,null,null,null),z=R.exports,U=a(5353),F={name:"sessao-plenaria-online",components:{SessaoPlenariaTopo:p,PautaOnline:z},data(){return{sessao:null,idd:parseInt(this.$route.params.id),app:["sessao"],model:["sessaoplenaria"]}},beforeDestroy:function(){this.setNivelDetalheVisivel(!1)},mounted(){let t=this;t.setNivelDetalheVisivel(!0),t.setSideleftVisivel(!0),t.setSiderightVisivel(!0),t.$nextTick(()=>{t.getObject({action:"",id:t.idd,app:t.app[0],model:t.model[0]}).then(t=>{this.sessao=t}).catch(()=>{this.sessao=void 0!==this.cache.sessao&&void 0!==this.cache.sessao.sessaoplenaria&&void 0!==this.cache.sessao.sessaoplenaria[this.idd]?this.cache.sessao.sessaoplenaria[this.idd]:null})})},methods:{...U.Ay.mapActions(["setNivelDetalheVisivel","setSideleftVisivel","setSiderightVisivel"]),fetch(t){let e=this;t.id===this.idd&&t.app===this.app[0]&&t.model===this.model[0]&&("post_delete"===t.action?setTimeout(()=>{e.sendMessage({alert:"danger",message:"Sessão Plenária foi excluída",time:5}),e.$router.push({name:"sessao_list_link"})},500):this.sessao=this.cache.sessao.sessaoplenaria[this.idd])}}},H=F,Y=(0,c.A)(H,s,i,!1,null,null,null),K=Y.exports}}]);