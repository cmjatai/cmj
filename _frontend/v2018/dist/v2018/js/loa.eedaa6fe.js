(function(){"use strict";var e={5461:function(e,a,t){t(1774);var n=t(4335),s=(t(4114),t(8111),t(2489),t(116),t(7588),t(3110),t(8335),t(2543)),i=t(4692);class r{constructor(e){this.container=e,this.form=e.find("form"),this.init()}isObjectEmpty(e){let a=!0;return s.forOwn(e,(e,t)=>{Array.isArray(e)&&e.length>0?a=!1:Array.isArray(e)||["",null,void 0].includes(e)||(a=!1)}),a}init(){const e=this.form,a=new FormData(e[0]),t={};for(const[s,i]of a.entries())s in t?(Array.isArray(t[s])||(t[s]=[t[s]]),t[s].push(i)):""!==i&&(t[s]=i);delete t.agrupamento,delete t.tipo_agrupamento,delete t.pdf;const n=()=>{const a=new FormData(e[0]),t=a.getAll("parlamentares"),n=a.getAll("fase"),s=a.get("finalidade"),i=a.getAll("tipo");return{parlamentares:t.length>0?t:[],fase:n.length>0?n:[],finalidade:""!==s?[s]:[],tipo:i.length>0?i:[]}};if(this.isObjectEmpty(t))try{const a=localStorage.getItem("portalcmj_emendaloa_filter");if(a){const t=JSON.parse(a);if(!this.isObjectEmpty(t)){s.forOwn(t,(a,t)=>{s.forEach(e.find(`input[name="${t}"]`),e=>{Array.isArray(a)&&a.includes(e.value)||a===e.value?(e.checked=!0,i(`label[for="${e.id}"] span`).addClass("active")):Array.isArray(a)?Array.isArray(a)&&a.length>0&&"text"===e.type&&(e.value=a[0]):e.value=a})});const a=n();this.isObjectEmpty(a)||(window.loadingCMJ("Atualizando listagem..."),e.submit())}}}catch(l){localStorage.removeItem("portalcmj_emendaloa_filter")}else{const e=n();localStorage.setItem("portalcmj_emendaloa_filter",JSON.stringify(e))}let r=a=>{const t=n();localStorage.setItem("portalcmj_emendaloa_filter",JSON.stringify(t)),window.loadingCMJ("Atualizando listagem..."),e.submit()};const o=e.find('input[type="checkbox"][name="agrupamento"]'),d=e.find('input[type="radio"][name="tipo_agrupamento"]');o.change(e=>{0===o.filter(":checked").length&&d.filter('[value="sem_registro"]').prop("checked",!0)}).change(),d.change(e=>{e.target.checked&&"sem_registro"===e.target.value?(o.not('[value="despesa__unidade"]').prop("disabled",!0).prop("checked",!1).parent().addClass("d-none"),o.filter('[value="despesa__unidade"]').prop("disabled",!1).parent().removeClass("d-none"),o.filter('[value="despesa__unidade"]').prop("checked",!0)):e.target.checked?(o.prop("disabled",!1).parent().removeClass("d-none"),0===o.filter(":checked").length&&(o.length>1?i(o[1]).prop("checked",!0):o.length>0&&i(o[0]).prop("checked",!0))):o.prop("disabled",!1).parent().removeClass("d-none")}).change(),e.find('#div_id_parlamentares input[type="checkbox"]').change(e=>{r()}),e.find('button[type="button"]').click(e=>{r()}),e.find('input[type="submit"]').click(e=>{window.loadingCMJ("Gerando Listagem em PDF...")}),e.keypress(e=>{if(13===e.keyCode)return e.preventDefault(),!1})}}class o{constructor(e){this.container=e,this.form=e.find("form")}toggleTipo(){const e=this.form,a=e.find('select[name="tipo"]')[0],t=e.find("#div_id_parl_assinantes"),n=e.find("#div_id_parlamentares__valor"),s=e.find('input[name="valor"]')[0];"0"!==a.value?t.length>0&&(s.setAttribute("readonly","readonly"),t.find("input").prop("disabled",!0),t[0].classList.add("d-none")):n.length>0&&(s.removeAttribute("readonly"),n.find("input").prop("disabled",!0),n[0].classList.add("d-none")),e.find('select[name="tipo"]').change(e=>{const a=e.target;"0"===a.value?(n.find("input").prop("disabled",!0),n[0].classList.add("d-none"),t[0].classList.remove("d-none"),t.find("input").prop("disabled",!1),s.removeAttribute("readonly")):(t.find("input").prop("disabled",!0),t[0].classList.add("d-none"),n[0].classList.remove("d-none"),n.find("input").prop("disabled",!1),s.setAttribute("readonly","readonly"))})}}class d extends o{constructor(e){super(e),this.init()}init(){this.toggleTipo()}}var l=t(2543),p=t.n(l),c=t(4692),u=t.n(c);class m extends o{constructor(e){super(e),this.pk=window.location.href.matchAll(/emendaloa\/(\d+)\//g).next().value[1],this.urlBase=`/api/loa/emendaloa/${this.pk}`,this.ano_loa=this.form.find('input[name="ano_loa"')[0].value,this.pkObject=null,this.init()}async init(){await this.loadPkObject(),this.toggleTipo(),this.setupPreview(),this.setupRegistroRender(),this.loadRegistrosContabeis(),this.setupBuscaDespesa(),this.setupFormEvents(),this.setupPopovers(),this.form.trigger("change")}async loadPkObject(){try{const e=await n.A.get(`${this.urlBase}/`);this.pkObject=e.data}catch(e){}}setupPreview(){const e=u()(".container-preview");e.html(`\n      <div class="inner-preview">\n        <a class="w-100" target="_blank" href="${this.urlBase}/view/">\n          <img src="${this.urlBase}/view/?page=1&u=${Date.now()}"/>\n        </a>\n      </div>\n      <div class="btn-toolbar justify-content-between">\n        <div class="btn-group btn-group-sm">\n          <label for="id_lineHeight">\n            <span>Entrelinha (%)</span>\n            <input type="number"\n              name="lineHeight" value="${this.pkObject.metadata.style.lineHeight}"\n              step="5"\n              min="100"\n              max="350"\n              class="numberinput form-control text-center"\n              id="id_lineHeight">\n          </label>\n        </div>\n        <div>\n          <label for="id_espacoAssinatura">\n          <input type="checkbox"\n            ${this.pkObject.metadata.style.espacoAssinatura?"checked":""}\n            name="espacoAssinatura"\n            class="form-check-input"\n            id="id_espacoAssinatura">\n          <span>Incluir espaço para Assinaturas</span>\n          </label>\n        </div>\n      </div>\n    `),this.previewImg=e.find("img")[0],this.previewImg.onload=()=>{this.previewImg.style.opacity=1,this.loadPkObject()}}updatePreview(e={}){if(!this.previewImg)return;this.previewImg.style.opacity=.35;let a=`?page=1&u=${Date.now()}`;for(const[t,n]of Object.entries(e))a+=`&${t}=${n}`;this.previewImg.src=`${this.urlBase}/view/${a}`}setupRegistroRender(){const e=this.form.find(".registro-render");e.html(""),u()('<div class="inner"></div>').appendTo(e),u()('<div class="footer"></div>').appendTo(e)}loadRegistrosContabeis(e=!1){const a=this.form.find(".registro-render .inner"),t=this.form.find(".registro-render .footer");n.A.get(`/api/loa/emendaloa/${this.pk}/totais/`).then(e=>{t.html(""),u()(`\n          <div class="row">\n            <div class="col-12 totais">TOTAIS:</div>\n            <div class="col">\n              <span class="key">Inserções</span>\n              <span class="value">${e.data.soma_insercoes}</span>\n            </div>\n            <div class="col">\n              <span class="key">Deduções</span>\n              <span class="value">${e.data.soma_deducoes}</span>\n            </div>\n            <div class="col text-${"0,00"===e.data.divergencia_registros?"blue":"red"}">\n              <span class="key">Inserções + Deduções</span>\n              <span class="value">${e.data.divergencia_registros}</span>\n            </div>\n            <div class="col text-${"0,00"===e.data.divergencia_emenda?"blue":"red"}">\n              <span class="key">Emenda - Inserções</span>\n              <span class="value">${e.data.divergencia_emenda}</span>\n            </div>\n          </div>\n        `).appendTo(t)}),n.A.get(`/api/loa/emendaloaregistrocontabil/?emendaloa=${this.pk}&get_all=true`).then(t=>{e&&a.html(""),p().each(t.data,e=>{if(a.find(`.item-rc[pk="${e.id}"]`).length>0)return;const t=u()(`<div class="item-rc" pk="${e.id}"></div>`);t.appendTo(a);let n=e.__str__,s=n.search(/(\d) /g),i=0;while(s>0&&s<15&&i<20)n=n.replace(/^R\$/g,"R$ "),s=n.search(/(\d) /g),i+=1;n=n.split(" - "),n[0]=`<strong>${n[0]}</strong>`,n=n.join(" - "),n=n.replaceAll(" ","&nbsp;"),u()(`<span class="texto">${n}</span>`).appendTo(t),u()('<span class="btn btn-sm btn-delete text-danger"><i class="far fa-trash-alt"></i></span>').appendTo(t).click(e=>this.handleDeleteRegistro(e))})})}handleDeleteRegistro(e){const a=e.target.closest(".item-rc").getAttribute("pk"),t=this.form.find(".registro-render .inner");n.A.delete(`/api/loa/emendaloaregistrocontabil/${a}/`).then(()=>{this.form.trigger("change"),e.target.closest(".item-rc").remove(),this.loadRegistrosContabeis(),this.updatePreview()}).catch(e=>{p().isString(e.response)||p().isString(e.response.data)?u()(`<div class="alert alert-danger">${e.message}</div>`).appendTo(t):p().forOwn(e.response.data,(e,a)=>{this.form.find(`input[name=despesa_${a}], input[name=${a}_despesa]`).addClass("is-invalid"),u()(`<div class="alert alert-danger">${p().isString(e)?e:e[0]}</div>`).appendTo(t)})})}setupBuscaDespesa(){const e=this.form.find(".busca-render"),a=this.form.find('input[name="busca_despesa"]'),t=this.form.find("#add_registro"),n=this.form.find("#clean_form_search");n.click(()=>{t[0].data=null,this.form.find('input[name^="despesa_"], input[name$="_despesa"]').val("").attr("readonly",!1).removeClass("is-invalid")}),t.click(()=>this.handleAddRegistro(t,e)),a.keyup(a=>this.handleBuscaDespesaKeyup(a,t,e))}handleAddRegistro(e,a){let t=e[0].data,s={emendaloa:this.pk,despesa:t,codigo:this.form.find('input[name="despesa_codigo"]').val(),orgao:this.form.find('input[name="despesa_orgao"]').val(),unidade:this.form.find('input[name="despesa_unidade"]').val(),especificacao:this.form.find('input[name="despesa_especificacao"]').val(),natureza:this.form.find('input[name="despesa_natureza"]').val(),fonte:this.form.find('input[name="despesa_fonte"]').val(),valor:this.form.find('input[name="valor_despesa"]').val()};a.html("");const i=u()('<div class="inner"></div>');n.A.post("/api/loa/emendaloaregistrocontabil/create_for_emendaloa_update/",s).then(()=>{e[0].data=null,this.form.find('input[name^="despesa_"], input[name$="_despesa"]').val("").attr("readonly",!1).removeClass("is-invalid"),u()('<div class="alert alert-info>Registro de Despesa Adicionado com sucesso.</div>').appendTo(i),this.loadRegistrosContabeis(),this.updatePreview(),this.form.trigger("change")}).catch(e=>{p().isString(e.response)||p().isString(e.response.data)?u()(`<div class="alert alert-danger">${e.message}</div>`).appendTo(i):p().forOwn(e.response.data,(e,a)=>{this.form.find(`input[name=despesa_${a}], input[name=${a}_despesa]`).addClass("is-invalid"),u()(`<div class="alert alert-danger">${p().isString(e)?e:e[0]}</div>`).appendTo(i)})}).finally(()=>{i.appendTo(a)})}handleBuscaDespesaKeyup(e,a,t){if(""===e.target.value.trim())return a[0].data=null,this.form.find('input[name^="despesa_"]').attr("readonly",!1),this.form.find('input[name^="despesa_"], input[name$="_despesa"]').removeClass("is-invalid"),void t.html("");n.A.get(`/api/loa/despesaconsulta/search/?page_size=10&ano=${this.ano_loa}&q=${e.target.value}`).then(n=>{t.html("");const s=u()('<div class="inner"></div>');if(s.appendTo(t),p().isEmpty(n.data.results))a[0].data=null,this.form.find('input[name^="despesa_"]').attr("readonly",!1),u()('<div class="alert alert-warning">\n            Nenhuma despesa encontrada nos anexos da LOA com esta informação. Você pode ainda fazer o registro manualmente no formulário acima.\n          </div>').appendTo(s);else if(n.data.pagination.total_entries>10){let e=`<div class="alert alert-warning">\n            <em>Mostrando 10 primeiros resultados de ${n.data.pagination.total_entries}.<br>Informe mais termos no campo de busca para reduzir os resultados.</em>\n          </div>`;u()(e).appendTo(s)}let i=e.target.value.trim().split(" ");p().each(n.data.results,e=>{let n=`Órgão...: ${e.cod_orgao} - ${e.esp_orgao}\n              Und Orç.: ${e.cod_unidade} - ${e.esp_unidade}\n              Código..: ${e.codigo} - ${e.especificacao}\n              Natureza: ${e.cod_natureza} - ${e.esp_natureza} // Fonte: ${e.cod_fonte}\n              Val.Orç.: ${e.str_valor} | Saldo: ${e.str_saldo}`;p().each(i,e=>{if(e.length<3)return;const a=new RegExp(`(${e})`,"ig");n=n.replace(a,'<strong class="highlight">$1</strong>')}),n=n.replaceAll("\n","<br/>");let r=`<div class="small item" pk="${e.id}">${n}</div>`,o=u()(r).appendTo(s);o.click(n=>{this.form.find('input[name="despesa_codigo"]').val(e.codigo),this.form.find('input[name="despesa_orgao"]').val(e.cod_orgao),this.form.find('input[name="despesa_unidade"]').val(e.cod_unidade),this.form.find('input[name="despesa_especificacao"]').val(e.especificacao),this.form.find('input[name="despesa_natureza"]').val(e.cod_natureza),this.form.find('input[name="despesa_fonte"]').val(e.cod_fonte),this.form.find('input[name^="despesa_"]').attr("readonly",!0);let s=n.currentTarget.getAttribute("pk");a[0].data=s,t.html("")})})})}setupFormEvents(){const e=this.form.find('input[name="busca_despesa"]'),a=this.form.find(".busca-render");this.form.keypress(t=>{if(13===t.keyCode){if(t.preventDefault(),t.target===e[0]){const e=a.find(".inner"),t=e.children();1===t.length&&t.trigger("click")}return!1}}),this.form.find('select[name="fase"]').change(e=>{const a=e.target;"10"===a.value?a.classList.add("is-invalid"):a.classList.remove("is-invalid")}),this.form.change(e=>this.handleAutoSave(e))}handleAutoSave(e){let a={},t=e.target.name,s=e.target.value;if(!t)return;let i="/",r=e.target.getAttribute("parlamentar_id");if(null!==r)a["valor"]=s,a["parlamentar_id"]=r,i="/updatevalorparlamentar/";else{if("lineHeight"===t)return void this.updatePreview({lineHeight:s});if("espacoAssinatura"===t)return void this.updatePreview({espacoAssinatura:e.target.checked});"parl_assinantes"===t?(i="/update_parlassinantes/",a["parlamentar_id"]=s,a["checked"]=e.target.checked):"valor"===t?(i="/updatevaloremenda/",a["valor"]=s):a[t]=s}this.previewImg&&(this.previewImg.style.opacity=.35),n.A.patch(`${this.urlBase}${i}`,a).then(e=>{this.form.find('input[name="lineHeight"]').val(e.data.metadata.style.lineHeight),this.form.find('input[name="valor"]').val(e.data.valor),"tipo"===t&&window.location.reload(),this.loadRegistrosContabeis(!0),this.updatePreview()}).catch(()=>{window.location.reload()})}setupPopovers(){}}var h=t(4692);class f{constructor(){const e=h(".container-loa");e.hasClass("emendaloa-update")?this.EmendaLoaUpdate=new m(e):e.hasClass("emendaloa-create")?this.EmendaLoaCreate=new d(e):e.hasClass("emendaloa-list")&&(this.EmendaLoaList=new r(e))}}class g{constructor(e){this.container=e,this.form=e.find("form"),this.pk=window.location.href.matchAll(/agrupamento\/(\d+)\//g).next().value[1],this.urlBase=`/api/loa/agrupamento/${this.pk}`,this.ano_loa=this.form.find('input[name="ano_loa"')[0].value,this.init()}init(){this.setupRegistroRender(),this.loadRegistrosContabeis(),this.setupBuscaDespesa(),this.setupEmendasAgrupamento(),this.setupFormEvents(),this.form.trigger("change")}setupRegistroRender(){const e=this.form.find(".registro-render");e.html(""),u()('<div class="inner"></div>').appendTo(e),u()('<div class="footer"></div>').appendTo(e)}loadRegistrosContabeis(){const e=this.form.find(".registro-render .inner");n.A.get(`/api/loa/agrupamentoregistrocontabil/?agrupamento=${this.pk}&get_all=true`).then(a=>{p().each(a.data,a=>{if(e.find(`.item-rc[pk="${a.id}"]`).length>0)return;const t=u()(`<div class="item-rc" pk="${a.id}"></div>`);t.appendTo(e);let n=a.__str__,s=n.search(/(\d)%/g),i=0;while(s>0&&s<6&&i<10)n=" "+n,s=n.search(/(\d)%/g),i+=1;n=n.split(" - "),n[0]=`<strong>${n[0]}</strong>`,n=n.join(" - "),n=n.replaceAll(" ","&nbsp;"),u()(`<span class="texto">${n}</span>`).appendTo(t),u()('<span class="btn btn-sm btn-delete text-danger"><i class="far fa-trash-alt"></i></span>').appendTo(t).click(e=>this.handleDeleteRegistro(e))})})}handleDeleteRegistro(e){const a=e.target.closest(".item-rc").getAttribute("pk");n.A.delete(`/api/loa/agrupamentoregistrocontabil/${a}/`).then(()=>{this.form.trigger("change"),e.target.closest(".item-rc").remove(),this.loadRegistrosContabeis()})}setupBuscaDespesa(){const e=this.form.find(".busca-render"),a=this.form.find('input[name="busca_despesa"]'),t=this.form.find("#add_registro"),n=this.form.find("#clean_form_search");n.click(()=>{t[0].data=null,this.form.find('input[name^="despesa_"], input[name$="_despesa"]').val("").attr("readonly",!1).removeClass("is-invalid")}),t.click(()=>this.handleAddRegistro(t,e)),a.keyup(a=>this.handleBuscaDespesaKeyup(a,t,e))}handleAddRegistro(e,a){let t=e[0].data,s={agrupamento:this.pk,despesa:t,codigo:this.form.find('input[name="despesa_codigo"]').val(),orgao:this.form.find('input[name="despesa_orgao"]').val(),unidade:this.form.find('input[name="despesa_unidade"]').val(),especificacao:this.form.find('input[name="despesa_especificacao"]').val(),natureza:this.form.find('input[name="despesa_natureza"]').val(),fonte:this.form.find('input[name="despesa_fonte"]').val(),percentual:this.form.find('input[name="perc_despesa"]').val()};a.html("");const i=u()('<div class="inner"></div>');n.A.post("/api/loa/agrupamentoregistrocontabil/create_for_agrupamento_update/",s).then(()=>{e[0].data=null,this.form.find('input[name^="despesa_"], input[name$="_despesa"]').val("").attr("readonly",!1).removeClass("is-invalid"),this.form.find('input[name="perc_despesa"]').val("100,00"),u()('<div class="alert alert-info>Registro de Despesa Adicionado com sucesso.</div>').appendTo(i),this.loadRegistrosContabeis(),this.form.trigger("change")}).catch(e=>{p().isString(e.response)||p().isString(e.response.data)?u()(`<div class="alert alert-danger">${e.message}</div>`).appendTo(i):p().forOwn(e.response.data,(e,a)=>{this.form.find(`input[name=despesa_${a}], input[name=${a}_despesa]`).addClass("is-invalid"),u()(`<div class="alert alert-danger">${p().isString(e)?e:e[0]}</div>`).appendTo(i)})}).finally(()=>{i.appendTo(a)})}handleBuscaDespesaKeyup(e,a,t){if(this.form.find('input[name^="despesa_"], input[name$="_despesa"]').removeClass("is-invalid"),""===e.target.value.trim())return a[0].data=null,this.form.find('input[name^="despesa_"]').attr("readonly",!1),void t.html("");n.A.get(`/api/loa/despesaconsulta/search/?page_size=5&ano=${this.ano_loa}&q=${e.target.value}`).then(n=>{t.html("");const s=u()('<div class="inner"></div>');s.appendTo(t),p().isEmpty(n.data.results)&&(a[0].data=null,this.form.find('input[name^="despesa_"]').attr("readonly",!1),u()('<div class="alert alert-warning">\n            Nenhuma despesa encontrada nos anexos da LOA com esta informação. Você pode ainda fazer o registro manualmente no formulário acima.\n          </div>').appendTo(s));let i=e.target.value.trim().split(" ");p().each(n.data.results,e=>{let n=`\n              Órgão...: ${e.cod_orgao} - ${e.esp_orgao}\n              Und Orç.: ${e.cod_unidade} - ${e.esp_unidade}\n              Código..: ${e.codigo} - ${e.especificacao}\n              Natureza: ${e.cod_natureza} - ${e.esp_natureza} // Fonte: ${e.cod_fonte}\n              Val.Orç.: ${e.str_valor} | Saldo: ${e.str_saldo}`;p().each(i,e=>{const a=new RegExp(`(${e})`,"ig");n=n.replace(a,'<strong class="highlight">$1</strong>')}),n=n.replaceAll("\n","<br/>");let r=`<div class="small item" pk="${e.id}">${n}</div>`,o=u()(r).appendTo(s);o.click(n=>{this.form.find('input[name="despesa_codigo"]').val(e.codigo),this.form.find('input[name="despesa_orgao"]').val(e.cod_orgao),this.form.find('input[name="despesa_unidade"]').val(e.cod_unidade),this.form.find('input[name="despesa_especificacao"]').val(e.especificacao),this.form.find('input[name="despesa_natureza"]').val(e.cod_natureza),this.form.find('input[name="despesa_fonte"]').val(e.cod_fonte),this.form.find('input[name^="despesa_"]').attr("readonly",!0);let s=n.currentTarget.getAttribute("pk");a[0].data=s,t.html("")})})})}setupEmendasAgrupamento(){const e=this.form.find('input[name="busca_emendaloa"]');this.loadEmendasAgrupamento(),e.keyup(e=>this.handleBuscaEmendaKeyup(e))}loadEmendasAgrupamento(){const e=this.form.find(".emendaloa-selecteds"),a=this.form.find(".busca-render-emendaloa");n.A.get(`/api/loa/agrupamento/${this.pk}/emendas/?&get_all=true`).then(t=>{e.html("");const s=u()('<div class="inner"></div>');s.appendTo(e),p().each(t.data,e=>{const t=u()('<div class="inner-item"></div>').appendTo(s);this.renderEmendaItem(e,t);const i=u()('<div class="inner-actions"></div>').appendTo(t);u()(`<span class="btn btn-delete text-danger" pk="${e.id}" title="Remover Emenda do Agrupamento."><i class="far fa-trash-alt"></i></span>`).appendTo(i).click(e=>{let t=e.currentTarget.getAttribute("pk"),i={agrupamento:this.pk,emendaloa:t};n.A.post("/api/loa/agrupamentoemendaloa/delete/",i).then(()=>{this.loadEmendasAgrupamento()}).catch(e=>{a.find(".alert").remove(),s.prepend(u()(`<div class="alert alert-danger">${e.message}</div>`))})})})})}handleBuscaEmendaKeyup(e){if(e.ctrlKey)return;const a=this.form.find(".busca-render-emendaloa"),t=this.form.find(".emendaloa-selecteds");if(""===e.target.value.trim())return void a.html("");if(e.target.value.trim().length<3)return void a.html("Digite ao menos três letras");let s=e.target.value.trim().split(" ").filter(e=>e.length>=3);n.A.get(`/api/loa/emendaloa/search/?&get_all=true&ano=${this.ano_loa}&q=${s.join(" ")}`).then(e=>{a.html("");const i=u()('<div class="inner"></div>');i.appendTo(a),p().each(e.data,e=>{if(t.find(`.item-emendaloa[pk="${e.id}"]`).length>0)return;const r=u()('<div class="inner-item"></div>').appendTo(i);let o=this.renderEmendaItem(e,r,!0);p().each(s,e=>{const a=new RegExp(`(${e})`,"ig");o=o.replace(a,'<strong class="highlight">$1</strong>')}),r.html(o);const d=u()('<div class="inner-actions"></div>').appendTo(r);10!==e.fase&&u()(`<span class="btn text-blue" pk="${e.id}" title="Adicionar Emenda ao Agrupamento."><i class="far fa-arrow-alt-circle-right"></i></i></span>`).appendTo(d).click(e=>{let t=e.currentTarget.getAttribute("pk"),s={agrupamento:this.pk,emendaloa:t,emendaloa__fase:15};n.A.post("/api/loa/agrupamentoemendaloa/",s).then(e=>{a.find(`.item-emendaloa[pk="${e.data.emendaloa}"]`).parent().remove(),this.loadEmendasAgrupamento()}).catch(e=>{a.find(".alert").remove(),i.prepend(u()(`<div class="pt-2"><div class="alert alert-danger">${e.response.data[0]}</div></div>`))})})})})}renderEmendaItem(e,a,t=!1){let n=[];0===e.tipo?p().each(e.str_parlamentares,e=>{e=e.split(" - "),n.push(e[1])}):n=e.str_parlamentares,n=n.join("<br>");let s=`<div class="item-emendaloa" pk="${e.id}">\n        Valor da Emenda ${0!==e.tipo?"Impositiva":"Modificativa"}: <strong>R$ ${e.str_valor}</strong><br>\n        <strong>${e.indicacao}</strong><br>\n        <a href="${e.link_detail_backend}/edit" target="_blank">${e.finalidade}</a><br>\n        <small>${n}</small><br>\n        <span class="fase ${10===e.fase?"bg-danger":12===e.fase?"bg-warning":"bg-green"}">${e.str_fase}</span>\n      </div>`;if(t)return s;u()(s).appendTo(a)}setupFormEvents(){const e=this.form.find('input[name="busca_despesa"]'),a=this.form.find(".busca-render");this.form.keypress(t=>{if(13===t.keyCode){if(t.preventDefault(),t.target===e[0]){const e=a.find(".inner"),t=e.children();1===t.length&&t.trigger("click")}return!1}}),this.form.find('select[name="fase"]').change(e=>{const a=e.target;"10"===a.value?a.classList.add("is-invalid"):a.classList.remove("is-invalid")}),this.form.change(e=>this.handleAutoSave(e))}handleAutoSave(e){let a={},t=e.target.name,s=e.target.value;if(!t)return;let i="/";a[t]=s,n.A.patch(`${this.urlBase}${i}`,a).then(()=>{this.loadRegistrosContabeis()}).catch(()=>{})}}var v=t(4692);class _{constructor(){const e=v(".container-loa");e.hasClass("agrupamento-update")&&(this.AgrupamentoUpdate=new g(e))}}var b=t(2543);class ${constructor(){"undefined"!==typeof window&&(window.AppLOA=this),this.EmendaLoaCRUD=null,this.AgrupamentoCRUD=null}run(){this.EmendaLoaCRUD=new f,this.AgrupamentoCRUD=new _}isObjectEmpty(e){let a=!0;return b.forOwn(e,(e,t)=>{Array.isArray(e)&&e.length>0?a=!1:Array.isArray(e)||["",null,void 0].includes(e)||(a=!1)}),a}}var y=new $,k=t(4692);n.A.defaults.headers.get["Cache-Control"]="no-cache, no-store, must-revalidate",n.A.defaults.headers.get["Pragma"]="no-cache",n.A.defaults.headers.get["Expires"]="0",n.A.defaults.xsrfCookieName="csrftoken",n.A.defaults.xsrfHeaderName="X-CSRFToken",k(document).ready(function(){k(".container-loa").length>0&&y.run()})}},a={};function t(n){var s=a[n];if(void 0!==s)return s.exports;var i=a[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}t.m=e,function(){var e=[];t.O=function(a,n,s,i){if(!n){var r=1/0;for(p=0;p<e.length;p++){n=e[p][0],s=e[p][1],i=e[p][2];for(var o=!0,d=0;d<n.length;d++)(!1&i||r>=i)&&Object.keys(t.O).every(function(e){return t.O[e](n[d])})?n.splice(d--,1):(o=!1,i<r&&(r=i));if(o){e.splice(p--,1);var l=s();void 0!==l&&(a=l)}}return a}i=i||0;for(var p=e.length;p>0&&e[p-1][2]>i;p--)e[p]=e[p-1];e[p]=[n,s,i]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={341:0};t.O.j=function(a){return 0===e[a]};var a=function(a,n){var s,i,r=n[0],o=n[1],d=n[2],l=0;if(r.some(function(a){return 0!==e[a]})){for(s in o)t.o(o,s)&&(t.m[s]=o[s]);if(d)var p=d(t)}for(a&&a(n);l<r.length;l++)i=r[l],t.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return t.O(p)},n=self["webpackChunkportalcmj_frontend"]=self["webpackChunkportalcmj_frontend"]||[];n.forEach(a.bind(null,0)),n.push=a.bind(null,n.push.bind(n))}();var n=t.O(void 0,[1603,5914,8023,5386,1774],function(){return t(5461)});n=t.O(n)})();