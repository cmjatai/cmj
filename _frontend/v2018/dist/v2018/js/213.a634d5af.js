"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[213],{4213:function(e,s,a){a.r(s),a.d(s,{default:function(){return $}});var t=function(){var e=this,s=e._self._c;return e.classe?s("div",{staticClass:"doclist-layout container-fluid"},[s("bread-crumb-classe",{attrs:{parents:e.classe.parents}}),s("div",{staticClass:"row-fluid"},[s("div",{staticClass:"col"},[s("h2",[e._v(e._s(e.classe.titulo))]),s("small",{domProps:{innerHTML:e._s(e.descricao_html)}}),s("div",{staticClass:"inner-list"},e._l(e.arqdocs_ordered,function(a,t){return s("arq-doc-item",{key:`ad-${t}`,attrs:{arqdoc:a,classe:e.classe}},[e._v(" "+e._s(a.titulo)+" ")])}),1),s("div",{staticClass:"text-info"},[e._v("TODO: implementar paginação")])]),s("div",{staticClass:"col-3 d-none"},[s("div",{staticClass:"classechild"},[s("h4",[e._v(" Subclasses de "+e._s(e.classe.titulo)+" ")]),e._v(" "+e._s(e.params_node)+" - "+e._s(e.params_nodechild)+" ")])])])],1):e._e()},r=[],i=function(){var e=this,s=e._self._c;return s("div",{staticClass:"arq-doc-item",on:{mousemove:e.mouseMove}},[s("div",{staticClass:"inner"},[s("div",{staticClass:"titulo"},[e.arqdoc.checkcheck?s("i",{staticClass:"fas fa-xs fa-lock text-light-blue",attrs:{title:"ArqClasse Arquivada."}}):e._e(),e._v("  "),s("a",{attrs:{href:e.arqdoc.link_detail_backend,target:"_blank"}},[e._v(e._s(e.arqdoc.titulo))])]),s("div",{staticClass:"descricao",domProps:{innerHTML:e._s(e.arqdoc.descricao)}}),s("div",{staticClass:"rodape"},[s("span",{staticClass:"data"},[e._v(" Data do Documento: "+e._s(e.data_computed)+" ")]),s("span",{staticClass:"created"},[e._v(" Inclusão no ArqDoc: "+e._s(e.created_computed)+" ")])]),s("div",{staticClass:"rodape"},[e.contra_classe?s("bread-crumb-classe",{attrs:{parents:e.contra_classe.parents,me:e.contra_classe}}):e._e()],1),s("div",{ref:"preview",staticClass:"inner-preview"},[e.imgdisplay?s("img",{ref:"imgpreview",on:{error:e.errorPreview,load:e.loadPreview}}):e._e(),s("div",{ref:"preview_actions",staticClass:"actions"},[s("a",{staticClass:"previous",on:{click:e.clickPrevious}},[s("i",{staticClass:"fas fa-chevron-left"})]),s("a",{staticClass:"next",on:{click:e.clickNext}},[s("i",{staticClass:"fas fa-chevron-right"})])])])])])},c=[],o=(a(4603),a(7566),a(8721),a(7906)),n=function(){var e=this,s=e._self._c;return e.parents?s("nav",{attrs:{"aria-label":"breadcrumb"}},[s("ol",{staticClass:"breadcrumb"},e._l(e.parents_and_me,function(a,t){return s("li",{key:`cp-${t}`,staticClass:"breadcrumb-item"},[s("router-link",{attrs:{to:{name:"arqchildroute",params:{node:t>0?e.parents[t-1].id:"root",nodechild:a.id}}},nativeOn:{click:function(s){return e.clickItemBreadCrumb.apply(null,arguments)}}},[e._v(" "+e._s(a.titulo)+" ")])],1)}),0)]):e._e()},l=[],d={name:"bread-crumb-classe",props:["parents","me"],data(){return{parents_and_me:[]}},mounted(){const e=this;e.$nextTick().then(function(){void 0!==e.me?e.parents_and_me=e.parents.concat([{id:e.me.id,titulo:e.me.titulo}]):e.parents_and_me=e.parents})},computed:{},methods:{clickItemBreadCrumb(){this.$refs.noderoot.reload()}}},p=d,u=a(845),m=(0,u.A)(p,n,l,!1,null,null,null),_=m.exports,h={name:"arq-doc-item",components:{BreadCrumbClasse:_},props:["arqdoc","classe"],data(){return{imgdisplay:!1,img_src:null,dpi:72,page:1,contra_classe:null,ARQCLASSE_FISICA:100,ARQCLASSE_LOGICA:200}},watch:{dpi(e,s){this.img_src=`${this.arqdoc.arquivo}?page=${this.page}&dpi=${e}`},page(e,s){this.img_src=`${this.arqdoc.arquivo}?page=${e}&dpi=${this.dpi}`},img_src(e,s){const a=this;a.imgdisplay=!0,a.$nextTick(()=>{a.$refs.imgpreview.src=e})},img_src__blob(e,s){const a=this;(0,o.A)({url:e,method:"GET",responseType:"blob"}).then(e=>(a.imgdisplay=!0,e)).then(e=>{const s=new Blob([e.data],{type:"image/png"}),t=window.URL||window.webkitURL,r=t.createObjectURL(s);a.$refs.imgpreview.src=r}).catch(e=>{a.page>1?(a.page-=1,a.sendMessage({alert:"info",message:"Esta é a última página.",time:2})):a.sendMessage({alert:"info",message:"Esta é a primeira página.",time:2})})}},computed:{data_computed(){return this.arqdoc.data.split("-").reverse().join("/")},created_computed(){return new Date(this.arqdoc.created).toLocaleString()}},methods:{loadPreview(e){this.$refs.preview_actions.style.display="flex"},errorPreview(e){this.page>1?(this.page-=1,this.sendMessage({alert:"info",message:"Esta é a última página.",time:2})):this.sendMessage({alert:"info",message:"Esta é a primeira página.",time:2})},clickPrevious(e){this.page>1&&(this.page-=1)},clickNext(e){this.page+=1},mouseMove(e){null===this.img_src&&(this.img_src=`${this.arqdoc.arquivo}?page=${this.page}&dpi=${this.dpi}`);let s=(e.offsetX+30)/this.$vnode.elm.offsetWidth;s>.7&&(s=.7),e.target.closest(".inner-preview")||(this.$refs.preview.style.top=-100*s/1.7+"vh",this.$refs.preview.style.bottom=-100*s/1.7+"vh"),s>.5&&(this.dpi=300)}},mounted:function(){const e=this;e.$nextTick().then(function(){return e.getObject({action:"",app:"arq",model:"arqclasse",id:e.classe.perfil===e.ARQCLASSE_FISICA?e.arqdoc.classe_logica:e.arqdoc.classe_estrutural}).then(s=>(e.contra_classe=s,s)).catch(s=>e.sendMessage({alert:"danger",message:"Não foi possível recuperar classe selecionada...",time:5}))})}},g=h,v=(0,u.A)(g,i,c,!1,null,null,null),f=v.exports,C=a(2543),q={name:"doc-list-layout",components:{ArqDocItem:f,BreadCrumbClasse:_},data(){return{params_node:this.$route.params.node,params_nodechild:this.$route.params.nodechild,classe:null,node_key_localstorage:"portalcmj_arqnode_tree_opened",arqdocs:{},ARQCLASSE_FISICA:100,ARQCLASSE_LOGICA:200}},mounted(){const e=this;e.fetchClasse().then(s=>{C.each(e.classe.parents,function(s,a){localStorage.addArrayOfIds(e.node_key_localstorage,s.id)}),e.$emit("checkIsOpenedNodesTree");const a=e.classe.perfil===e.ARQCLASSE_FISICA?"classe_estrutural":"classe_logica";e.fetch(1,`&get_all=True&${a}=${e.classe.id}`)})},computed:{arqdocs_ordered:{get(){return C.orderBy(this.arqdocs,["id"],["desc"])}},descricao_html:function(){let e=this.classe.descricao;return e=e.replace("\r\n","<br>"),e=e.replace("\n","<br>"),e}},methods:{fetch(e=1,s=""){const a=this;return a.$set(a,"arqdocs",{}),a.utils.getModelOrderedList("arq","arqdoc","-data",e,s).then(e=>{C.each(e.data,function(e,s){a.$set(a.arqdocs,e.id,e)})}).catch(e=>a.sendMessage({alert:"danger",message:"Não foi possível recuperar os documentos...",time:5}))},fetchClasse(){const e=this;return"root"===e.params_nodechild?null:e.getObject({action:"",app:"arq",model:"arqclasse",id:e.params_nodechild}).then(s=>(e.classe=s,s)).catch(s=>e.sendMessage({alert:"danger",message:"Não foi possível recuperar classe selecionada...",time:5}))}}},b=q,k=(0,u.A)(b,t,r,!1,null,null,null),$=k.exports}}]);
//# sourceMappingURL=213.a634d5af.js.map