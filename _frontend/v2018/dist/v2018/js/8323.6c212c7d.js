"use strict";(self["webpackChunkPortalCMJ_Frontend_v2018"]=self["webpackChunkPortalCMJ_Frontend_v2018"]||[]).push([[8323],{8323:function(i,t,e){e.r(t),e.d(t,{default:function(){return Q}});var a=function(){var i=this,t=i._self._c;return t("div",{staticClass:"painelset-admin"},[t("div",{staticClass:"container-grid"},[t("div",{staticClass:"row header"},[t("div",{staticClass:"col"},[t("div",{staticClass:"titulo-evento"},[i._v(" "+i._s(i.evento?i.evento.name:"Carregando evento...")+" "),t("small",[i._v(" "+i._s(i.datahora_prevista_real[0])+" - "+i._s(i.datahora_prevista_real[1])+" "+i._s(i.datahora_prevista_real[2])+" ")])])]),t("div",{staticClass:"col-auto"},[i.cronometro?t("cronometro-base",{attrs:{cronometro_id:i.cronometro.id,css_class_controls:"hover",css_class:"cronometro-global",controls:["start","pause","resume","toggleDisplay"]},on:{cronometro_start:function(t){return i.startEvento()},cronometro_pause:function(t){return i.pauseEvento()},cronometro_resume:function(t){return i.resumeEvento()}}}):i._e()],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-5 container-individuos"},[i.evento?t("individuo-list",{ref:"individuoList",attrs:{evento:i.evento,pause_parent_on_start:i.cronometro&&i.cronometro.pause_parent_on_start}}):i._e()],1),t("div",{staticClass:"col-7 container-controls"},[i.evento?t("palavra-em-uso",{ref:"palavraEmUso",attrs:{evento:i.evento}}):i._e(),i.evento?t("visoes-control",{ref:"visoesControl",attrs:{evento:i.evento}}):i._e()],1)])]),i.cronometro&&"running"!==i.cronometro.state?t("div",{staticClass:"disabled"},[t("div",{staticClass:"overlay-paused"},[t("div",{staticClass:"text-paused"},[i.cronometro&&"paused"===i.cronometro.state?t("div",[i._v(" EVENTO EM SUSPENSÃO ")]):i.cronometro&&"stopped"===i.cronometro.state?t("div",[i._v("EVENTO NÃO INICIADO")]):i._e()])])]):i._e()])},o=[],n=(e(4114),e(6176)),s=function(){var i=this,t=i._self._c;return t("div",{staticClass:"individuo-list"},[t("div",{class:["individuo-base","manager",i.status_microfone?"":"muted"]},[t("div",{staticClass:"inner"},[t("div",{staticClass:"controls"},[t("button",{staticClass:"btn-action btn-fone",attrs:{title:"Ativar/Desativar Todos os Microfones"},on:{click:function(t){return i.toggleAllMicrofones()}}},[t("i",{class:i.status_microfone?"fas fa-2x fa-microphone":"fas fa-2x fa-microphone-slash"})])]),t("div",{staticClass:"inner-individuo py-2"},[i._v(i._s(i.individuos.length)+" CANAIS")]),t("div",{staticClass:"inner-individuo"},[t("div",{staticClass:"default-timer"},[t("button",{staticClass:"btn btn-link"},[t("i",{staticClass:"fas fa-arrow-down",on:{click:function(t){i.default_timer>60?i.default_timer-=60:i.default_timer=60}}})]),i._v(" Tempo Padrão: "+i._s((i.default_timer/60).toFixed(0))+" min "),t("button",{staticClass:"btn btn-link"},[t("i",{staticClass:"fas fa-arrow-up",on:{click:function(t){i.default_timer<600?i.default_timer+=60:i.default_timer=600}}})])])]),t("div",{staticClass:"inner-individuo"},[t("input",{directives:[{name:"model",rawName:"v-model",value:i.pause_parent_on_aparte,expression:"pause_parent_on_aparte"}],attrs:{type:"checkbox",id:"pause_parent_on_aparte",title:"Pausar o Cronômetro de quem está com a palavra quando alguém solicitar aparte"},domProps:{checked:Array.isArray(i.pause_parent_on_aparte)?i._i(i.pause_parent_on_aparte,null)>-1:i.pause_parent_on_aparte},on:{change:function(t){var e=i.pause_parent_on_aparte,a=t.target,o=!!a.checked;if(Array.isArray(e)){var n=null,s=i._i(e,n);a.checked?s<0&&(i.pause_parent_on_aparte=e.concat([n])):s>-1&&(i.pause_parent_on_aparte=e.slice(0,s).concat(e.slice(s+1)))}else i.pause_parent_on_aparte=o}}})])])]),t("div",{staticClass:"individuos"},i._l(i.individuos,function(e){return t("individuo-base",{key:`individuo-${e.id}-${e.order}`,ref:`individuo-${e.id}`,refInFor:!0,attrs:{individuo_id:e.id,default_timer:i.default_timer}})}),1)])},r=[],d=(e(8111),e(8767),e(2489),function(){var i=this,t=i._self._c;return t("div",{class:["individuo-base",i.individuo&&i.individuo.status_microfone?"":"muted",i.individuo&&i.individuo.parlamentar?"parlamentar":"",i.individuo&&i.individuo.com_a_palavra?"com-a-palavra":i.individuo&&i.individuo.microfone_sempre_ativo?"always-on":"active",i.individuo&&i.individuo.aparteado?"aparteante":""]},[t("div",{staticClass:"inner"},[t("div",{class:["inner-individuo",i.fotografiaUrl?"":"no-photo"],on:{click:function(t){return i.clickIndividuo(t)},dblclick:function(t){return i.dblclickIndividuo(t)}}},[t("div",{staticClass:"avatar"},[i.fotografiaUrl?t("img",{attrs:{src:i.fotografiaUrl,alt:"Foto do individuo"}}):t("i",{staticClass:"fas fa-user"})]),t("div",{staticClass:"name"},[i._v(" "+i._s(i.individuo?i.individuo.name:"Carregando indivíduo...")+" "),t("small",[i._v(i._s(i.individuo?`(${i.individuo.canal})`:""))])])]),t("div",{staticClass:"controls"},[i.individuo?t("button",{staticClass:"btn-action btn-fone",attrs:{title:i.individuo&&!i.individuo.status_microfone?"Ativar microfone":"Desativar microfone"},on:{click:function(t){return i.toggleMicrofone()}}},[t("i",{class:i.individuo&&i.individuo.status_microfone?"fas fa-2x fa-microphone":"fas fa-2x fa-microphone-slash"})]):i._e(),t("button",{staticClass:"btn-action btn-aparte",attrs:{title:"Solicitar aparte"},on:{click:function(t){return t.preventDefault(),i.clickIndividuo(t)}}},[t("i",{staticClass:"fas fa-hand-rock"})]),t("button",{staticClass:"btn-action btn-palavra",attrs:{title:"Solicitar a palavra"},on:{click:function(t){return t.stopPropagation(),i.dblclickIndividuo(t)}}},[t("i",{staticClass:"fas fa-hand-paper"})]),i._e()])])])}),l=[],c=(e(116),e(3412)),u={name:"individuo-base",props:{individuo_id:{type:Number,required:!0},default_timer:{type:Number,required:!1,default:300},default_timer_aparteante:{type:Number,required:!1,default:60}},data(){return{click_timeout:null}},computed:{individuoComPalavra:{get(){return this.data_cache?.painelset_individuo&&Object.values(this.data_cache.painelset_individuo).find(i=>i.com_a_palavra&&i.evento===this.individuo.evento)||null}},individuo:function(){return this.data_cache?.painelset_individuo&&this.individuo_id&&this.data_cache.painelset_individuo[this.individuo_id]||null},fotografiaUrl:function(){return this.individuo?.fotografia?"/api/painelset/individuo/"+this.individuo.id+"/fotografia.c96.png":this.individuo?.parlamentar?"/api/parlamentares/parlamentar/"+this.individuo.parlamentar+"/fotografia.c96.png":""}},mounted(){c.l.$on("toggle-microfone-individuo",i=>{i===this.individuo_id&&this.toggleMicrofone()})},methods:{toggleMicrofone:function(){this.sendUpdate("toggle_microfone",{status_microfone:this.individuo?.status_microfone?"off":"on",default_timer:this.default_timer,com_a_palavra:this.individuo?.com_a_palavra?1:0})},clickIndividuo:function(i){const t=this;clearTimeout(t.click_timeout),t.click_timeout=setTimeout(()=>{if(t.individuo?.com_a_palavra||!t.individuoComPalavra)return t.individuo===t.individuoComPalavra?void t.sendMessage({alert:"error",message:"A palavra já está sendo utilizada por este indivíduo.",time:7}):void this.sendMessage({alert:"error",message:"A palavra não está sendo utilizada. Não é possível fazer aparte.",time:7});t.sendUpdate("toggle_aparteante",{aparteante_status:t.individuo.aparteado?0:1,default_timer:t.default_timer_aparteante||60})},600)},dblclickIndividuo:function(i){clearTimeout(this.click_timeout),this.sendUpdate("toggle_microfone",{status_microfone:this.individuo?.status_microfone||!this.individuo?.com_a_palavra?"on":"off",default_timer:this.default_timer,com_a_palavra:this.individuo?.com_a_palavra?0:1})},sendUpdate(i,t){return this.utils.patchModelAction("painelset","individuo",this.individuo_id,i,t).then(i=>{}).catch(i=>{this.sendMessage({alert:"error",message:"Erro ao atualizar indivíduo: "+i.response.data,time:5})})}}},v=u,p=e(1656),_=(0,p.A)(v,d,l,!1,null,null,null),m=_.exports,f=e(2543),h={name:"individuo-list",props:{evento:{type:Object,required:!0},pause_parent_on_start:{type:Boolean,required:!1,default:!1}},components:{IndividuoBase:m},data(){return{init:!1,status_microfone:!1,pause_parent_on_aparte:this.pause_parent_on_start,default_timer:300}},computed:{individuos:{get(){return this.data_cache?.painelset_individuo?f.orderBy(f.filter(Object.values(this.data_cache.painelset_individuo),{evento:this.evento.id}),["order"],["asc"]):[]}},cronometros(){if(this.data_cache?.painelset_individuo){const i=[];for(const t of Object.values(this.data_cache.painelset_individuo))t.evento===this.evento.id&&t.cronometro&&i.push(this.data_cache.painelset_cronometro[t.cronometro]);return i}return[]}},watch:{individuos:{handler(i,t){this.status_microfone=this.individuos.every(i=>!0===i.status_microfone)},deep:!0},pause_parent_on_start:function(i,t){this.pause_parent_on_aparte=i},pause_parent_on_aparte:function(i,t){const e=this;if(e.cronometros&&e.cronometros.length>0&&e.cronometros[0]&&e.cronometros[0].pause_parent_on_start===i)return;const a={pause_parent_on_aparte:i?"on":"off"};e.utils.patchModelAction("painelset","evento",this.evento.id,"pause_parent_on_aparte",a).then(i=>{}).catch(i=>{this.sendMessage({alert:"error",message:"Erro ao atualizar Configurar Pausa: "+i.response.data,time:5})})}},mounted(){this.fetchSync({app:"painelset",model:"individuo",params:{evento:this.evento.id}})},methods:{toggleAllMicrofones(i=!0){const t=this;t.status_microfone=!t.status_microfone;const e={status_microfone:t.status_microfone?"on":"off",inclui_microfone_sempre_ativo:i?"on":"off"};t.utils.patchModelAction("painelset","evento",this.evento.id,"toggle_microfones",e).then(i=>{}).catch(i=>{this.sendMessage({alert:"error",message:"Erro ao atualizar Microfones: "+i.response.data,time:5})})}}},g=h,C=(0,p.A)(g,s,r,!1,null,null,null),b=C.exports,y=function(){var i=this,t=i._self._c;return t("div",{staticClass:"palavraemuso-component"},[i.individuo?t("div",{key:`individuo-com-a-palavra-${i.individuo.id}`,ref:`individuo-com-a-palavra-${i.individuo.id}`,class:["individuo-com-a-palavra"]},[t("div",{staticClass:"inner-individuo"},[t("div",{staticClass:"individuo-header"},[t("div",{staticClass:"name"},[i._v(" "+i._s(i.individuo?i.individuo.name:"Carregando indivíduo...")+" ")])])]),t("div",{staticClass:"inner-individuo"},[t("div",{staticClass:"individuo"},[t("div",{staticClass:"avatar"},[i.fotografiaUrl?t("img",{attrs:{src:i.fotografiaUrl,alt:"Foto do indivíduo"}}):t("i",{staticClass:"fas fa-user-circle fa-2x"})])]),t("div",{staticClass:"divide"}),t("div",{staticClass:"cronometro"},[t("cronometro-palavra",{key:`cronometro-com-a-palavra-${i.individuo.cronometro}`,ref:`cronometro-com-a-palavra-${i.individuo.cronometro}`,attrs:{cronometro_id:i.individuo.cronometro}}),t("div",{staticClass:"icon-status-microfone",on:{click:i.toggleMicrofone}},[i.individuo&&i.individuo.status_microfone?t("i",{staticClass:"fas fa-microphone"}):t("i",{staticClass:"fas fa-microphone-slash"})])],1)])]):i._e(),i.individuo&&i.individuo.aparteante?t("individuo-aparteante",{key:`individuo-aparteante-${i.individuo.aparteante}`,ref:`individuo-aparteante-${i.individuo.aparteante}`,attrs:{individuo_id:i.individuo.aparteante}}):i._e()],1)},k=[],A=function(){var i=this,t=i._self._c;return t("div",{staticClass:"cronometro-palavra"},[t("cronometro-base",{key:`cronometro-palavra-${i.cronometro_id}`,ref:`cronometro-palavra-${i.cronometro_id}`,attrs:{cronometro_id:i.cronometro_id,css_class_controls:"visible",css_class:"cron-palavra",display_initial:"remaining",display_format:"mm:ss",display_size:"4em",auto_start:!0,controls:i.controls}})],1)},M=[],$={name:"cronometro-palavra",components:{CronometroBase:n.A},props:{cronometro_id:{type:Number,required:!0},controls:{type:Array,required:!1,default:function(){return["pause","resume","add30s","add1m","add3m","add5m"]}}},data(){return{}}},x=$,E=(0,p.A)(x,A,M,!1,null,null,null),w=E.exports,N=function(){var i=this,t=i._self._c;return t("div",{staticClass:"individuo-aparteante-component"},[i.individuo?t("div",{key:`individuo-aparteante-${i.individuo.id}`,ref:`individuo-aparteante-${i.individuo.id}`,class:["individuo-aparteante"]},[t("div",{staticClass:"inner-individuo"},[t("div",{staticClass:"individuo-header"},[t("div",{staticClass:"name"},[t("strong",[i._v("EM APARTE:")]),i._v(" "+i._s(i.individuo?i.individuo.name:"Carregando indivíduo...")+" ")])])]),t("div",{staticClass:"inner-individuo"},[t("div",{staticClass:"individuo"},[t("div",{staticClass:"avatar"},[i.fotografiaUrl?t("img",{attrs:{src:i.fotografiaUrl,alt:"Foto do parlamentar"}}):t("i",{staticClass:"fas fa-user-circle fa-2x"})])]),t("div",{staticClass:"divide"}),t("div",{staticClass:"cronometro"},[t("cronometro-palavra",{key:`cronometro-com-a-palavra-${i.individuo.cronometro}`,ref:`cronometro-com-a-palavra-${i.individuo.cronometro}`,attrs:{cronometro_id:i.individuo.cronometro,controls:["pause","resume","add30s","add1m"]}}),t("div",{staticClass:"icon-status-microfone",on:{click:i.toggleMicrofone}},[i.individuo&&i.individuo.status_microfone?t("i",{staticClass:"fas fa-microphone"}):t("i",{staticClass:"fas fa-microphone-slash"})])],1)])]):i._e()])},P=[],S={name:"individuo-aparteante",components:{CronometroPalavra:w},props:{individuo_id:{type:Number,required:!1,default:null}},data(){return{}},computed:{individuo:{get(){return this.individuo_id&&this.data_cache?.painelset_individuo&&this.data_cache.painelset_individuo[this.individuo_id]||null}},fotografiaUrl:function(){return this.individuo?.fotografia?"/api/painelset/individuo/"+this.individuo.id+"/fotografia.c96.png":this.individuo?.parlamentar?"/api/parlamentares/parlamentar/"+this.individuo.parlamentar+"/fotografia.c96.png":""}},methods:{toggleMicrofone:function(){c.l.$emit("toggle-microfone-individuo",this.individuo.id)}}},U=S,I=(0,p.A)(U,N,P,!1,null,null,null),q=I.exports,O={name:"palavra-em-uso",components:{CronometroPalavra:w,IndividuoAparteante:q},props:{evento:{type:Object,required:!0}},data(){return{}},computed:{individuo:{get(){return this.evento&&this.data_cache?.painelset_individuo&&Object.values(this.data_cache.painelset_individuo).find(i=>i.com_a_palavra&&i.evento===this.evento.id)||null}},fotografiaUrl:function(){return this.individuo?.fotografia?"/api/painelset/individuo/"+this.individuo.id+"/fotografia.c96.png":this.individuo?.parlamentar?"/api/parlamentares/parlamentar/"+this.individuo.parlamentar+"/fotografia.c96.png":""}},methods:{toggleMicrofone:function(){c.l.$emit("toggle-microfone-individuo",this.individuo.id)}}},j=O,T=(0,p.A)(j,y,k,!1,null,null,null),V=T.exports,z=function(){var i=this,t=i._self._c;return t("div",{staticClass:"painelset-visoes-control"},[t("div",{staticClass:"youtube_id"},[t("input",{directives:[{name:"model",rawName:"v-model",value:i.youtube_id,expression:"youtube_id"}],attrs:{type:"text"},domProps:{value:i.youtube_id},on:{change:function(t){return i.utils.patchModel("painelset","evento",i.evento.id,{youtube_id:i.youtube_id})},input:function(t){t.target.composing||(i.youtube_id=t.target.value)}}})]),i.painel?t("div",{staticClass:"inner"},[t("div",{staticClass:"checkbox-auto-select-visoes"},[t("input",{directives:[{name:"model",rawName:"v-model",value:i.painel.auto_select_visoes,expression:"painel.auto_select_visoes"}],attrs:{type:"checkbox",id:"autoSelectVisoes"},domProps:{checked:Array.isArray(i.painel.auto_select_visoes)?i._i(i.painel.auto_select_visoes,null)>-1:i.painel.auto_select_visoes},on:{change:[function(t){var e=i.painel.auto_select_visoes,a=t.target,o=!!a.checked;if(Array.isArray(e)){var n=null,s=i._i(e,n);a.checked?s<0&&i.$set(i.painel,"auto_select_visoes",e.concat([n])):s>-1&&i.$set(i.painel,"auto_select_visoes",e.slice(0,s).concat(e.slice(s+1)))}else i.$set(i.painel,"auto_select_visoes",o)},function(t){return i.utils.patchModel("painelset","painel",i.painel.id,{auto_select_visoes:i.painel.auto_select_visoes})}]}})]),t("div",{staticClass:"inner-visoes"},[t("div",{staticClass:"title-visao-ativa"},[i.visoes.length>0?t("div",i._l(i.visoes,function(e){return t("span",{key:`visao-ativa-${e.id}`},[e.active?t("span",[t("i",{staticClass:"fas fa-check-circle"}),i._v(" "+i._s(e.name)+" ")]):i._e()])}),0):i._e()]),t("div",{staticClass:"lista-visoes btn-group"},i._l(i.visoes,function(e){return t("a",{key:`visao-control-${e.id}`,class:["btn btn-secondary",e.active?"active":"",e.config.only_manual_activation?"btn-warning":""],attrs:{title:e.name},on:{click:function(t){return i.manualActiveVisao(e.id)}}},[i._v(" "+i._s(e.position)+" ")])}),0)])]):i._e()])},D=[],L=e(2543),F={name:"visoes-control",props:{evento:{type:Object,required:!0}},components:{},data(){return{evento_id:Number(this.$route.params.id),youtube_id:""}},watch:{evento:{handler(i){!this.finished&&i&&i.end_real&&(this.finished=!0,this.sendMessage({alert:"danger",message:"Evento já finalizado. Você pode copiá-lo para gerar um novo evento.",time:10}),this.$router.push({name:"painelset_evento_list_link"})),i&&(this.youtube_id=i.youtube_id||"",this.fetchSync({app:"painelset",model:"painel",params:{evento:i.id,principal:!0}}).then(()=>{this.fetchSync({app:"painelset",model:"visaodepainel",params:{painel:this.painel.id}})}))},immediate:!0}},computed:{painel:function(){return this.evento&&this.data_cache?.painelset_painel&&Object.values(this.data_cache?.painelset_painel).find(i=>i.evento===this.evento.id)||null},visoes:function(){return this.painel&&this.data_cache?.painelset_visaodepainel?L.orderBy(L.filter(Object.values(this.data_cache?.painelset_visaodepainel),{painel:this.painel.id}),["position"],["asc"]):[]}},mounted:function(){this.$nextTick(()=>{this.permissions.includes("painelset.change_evento")?(this.registerModels({app:"painelset",models:["evento","painel","visaodepainel"]}),this.fetchSync({app:"painelset",model:"evento",id:this.evento_id})):(this.$router.push({name:"online_index_link"}),this.sendMessage({alert:"danger",message:"Você não tem permissão para acessar esta página. aqui1",time:5}))})},methods:{manualActiveVisao:function(i){this.utils.patchModelAction("painelset","visaodepainel",i,"activate").then(i=>{}).catch(i=>{this.sendMessage({alert:"error",message:"Erro ao atualizar Visão Ativa: "+i.response.data,time:5})})}}},B=F,J=(0,p.A)(B,z,D,!1,null,null,null),R=J.exports,G={name:"painelset-admin",components:{CronometroBase:n.A,IndividuoList:b,PalavraEmUso:V,VisoesControl:R},data(){return{evento_id:Number(this.$route.params.id),finished:!1}},watch:{evento:{handler(i){if(!this.finished&&i&&i.end_real&&(this.finished=!0,this.sendMessage({alert:"danger",message:"Evento já finalizado. Você pode copiá-lo para gerar um novo evento.",time:10}),this.$router.push({name:"painelset_evento_list_link"})),i&&i.cronometro)return this.fetchSync({app:"painelset",model:"cronometro",id:i.cronometro})},immediate:!0}},computed:{evento:function(){return this.data_cache["painelset_evento"]?this.data_cache["painelset_evento"][this.evento_id]:null},cronometro:function(){return this.evento&&this.evento.cronometro&&this.data_cache["painelset_cronometro"]?this.data_cache["painelset_cronometro"][this.evento.cronometro]:null},datahora_prevista_real:function(){if(this.evento&&!this.evento.start_real){const i=new Date(this.evento.start_previsto);return["Início previsto",i.toLocaleDateString(),i.toLocaleTimeString()]}if(this.evento&&this.evento.start_real){const i=new Date(this.evento.start_real);return["Iniciado em",i.toLocaleDateString(),i.toLocaleTimeString()]}return["Data e hora não definidas","",""]}},mounted:function(){setTimeout(()=>{this.permissions.includes("painelset.change_evento")?this.fetchSync({app:"painelset",model:"evento",id:this.evento_id}):(this.$router.push({name:"online_index_link"}),this.sendMessage({alert:"danger",message:"Você não tem permissão para acessar esta página. aqui 2",time:5}))},1e3)},methods:{resumeEvento(){this.$refs.individuoList.status_microfone=0,this.$refs.individuoList.toggleAllMicrofones()},startEvento(){this.utils.patchModelAction("painelset","evento",this.evento.id,"start").then(i=>{}).catch(i=>{})},pauseEvento(){this.$refs.individuoList.status_microfone=1,this.$refs.individuoList.toggleAllMicrofones(!1)}}},H=G,K=(0,p.A)(H,a,o,!1,null,null,null),Q=K.exports}}]);