import{z as q,c as i,_ as P,w as z,f as n,g as l,k as r,i as v,F as g,r as O,G as N,j as y,t as u,n as j}from"./vendor-Dq9xiLvp.js";import{_ as C,b as E}from"./main-BzHxinO8.js";import"./vendor_fortawesome-D0qyeiI4.js";const T={class:"widget-registro-presenca-e-votacao"},V={class:"inner"},F={class:"nome"},M={key:0,class:"votacao"},w={class:"nome"},D={key:0,class:"votacao"},R={class:"nome"},U={key:0,class:"votacao"},W={class:"quorum"},G={class:"inner-quorum"},L={class:"ausentes-label"},Q={class:"quorum-label"},H={class:"quorum-value"},J={__name:"WidgetSessaoRegistroPresenca",props:{painelId:{type:Number,default:0},widgetSelected:{type:Number,default:0}},setup(I){const s=E(),x=I,d={Sim:["sim","SIM"],Não:["nao","NÃO"],Abstenção:["abst","ABSTENÇÃO"],NV:["nv","NÃO VOTOU"]},_=q(null),$=i(()=>Object.values(s.data_cache.sessao_ordemdia||{}).find(a=>a.sessao_plenaria===b.value?.sessao&&(a.discussao_aberta===!0||a.votacao_aberta===!0||a.votacao_aberta_pedido_prazo===!0))||Object.values(s.data_cache.sessao_expedientemateria||{}).find(a=>a.sessao_plenaria===b.value?.sessao&&(a.discussao_aberta===!0||a.votacao_aberta===!0||a.votacao_aberta_pedido_prazo===!0))||null),p=i(()=>{if(!_.value)return[];const a=Object.values(s.data_cache.sessao_votoparlamentar||{}).filter(e=>e.ordem===_.value.id&&_.value.__label__==="sessao_ordemdia"||e.expediente===_.value.id&&_.value.__label__==="sessao_expedientemateria"),t={};return a.forEach(e=>{t[e.parlamentar]=e}),t}),m=i(()=>s.data_cache.painelset_widget?.[x.widgetSelected]||null),b=i(()=>s.data_cache.painelset_painel?.[x.painelId]||null),c=i(()=>s.data_cache.sessao_sessaoplenaria?.[b.value?.sessao]||null),f=i(()=>{if(!c.value)return[];const a=Object.values(s.data_cache.sessao_integrantemesa||{}).filter(e=>e.sessao_plenaria===c.value.id),t=[];return a.forEach(e=>{const o=s.data_cache.parlamentares_parlamentar?.[e.parlamentar]||null,h=s.data_cache.parlamentares_cargomesa?.[e.cargo]||null;o&&h&&t.push({id:o.id,parlamentar:o.__str__,cargo:h.__str__})}),t}),A=i(()=>{if(!c.value)return[];const t=Object.values(s.data_cache.sessao_sessaoplenariapresenca||{}).filter(e=>e.sessao_plenaria===c.value.id).map(e=>s.data_cache.parlamentares_parlamentar?.[e.parlamentar]||null).filter(e=>e!==null&&f.value.every(o=>o.id!==e.id));return P.orderBy(t,["nome_parlamentar"],["asc"])}),S=i(()=>{if(!c.value)return[];const t=Object.values(s.data_cache.sessao_sessaoplenariapresenca||{}).filter(o=>o.sessao_plenaria===c.value.id).map(o=>o.parlamentar),e=Object.values(s.data_cache.parlamentares_parlamentar||{}).filter(o=>o.ativo&&!t.includes(o.id)&&f.value.every(h=>h.id!==o.id));return P.orderBy(e,["nome_parlamentar"],["asc"])}),B=i(()=>f.value.length+A.value.length);z(()=>$.value,a=>{if(a){_.value=a;const t={};a.__label__==="sessao_ordemdia"?t.ordem=a.id:a.__label__==="sessao_expedientemateria"&&(t.expediente=a.id),s.fetchSync({params:t,app:"sessao",model:"votoparlamentar"})}},{immediate:!0});const k=a=>`/api/parlamentares/parlamentar/${a}/fotografia.c128.png`;return(async()=>{s.fetchSync({app:"parlamentares",model:"parlamentar",params:{ativo:"True"}}).then(()=>s.fetchSync({app:"parlamentares",model:"cargomesa",params:{}}).then(()=>s.fetchSync({app:"sessao",model:"integrantemesa",params:{sessao_plenaria:c.value?.id}}))),s.fetchSync({app:"sessao",model:"sessaoplenariapresenca",params:{sessao_plenaria:c.value?.id}}),s.fetchSync({app:"sessao",model:"presencaordemdia",params:{sessao_plenaria:c.value?.id}})})(),(a,t)=>(l(),n("div",T,[r("div",V,[(l(!0),n(g,null,O(f.value,e=>(l(),n("div",{key:`integrante-${e.id}`,class:"integrante-mesa"},[r("div",{class:"foto",style:N(`background-image: url(${k(e.id)})`)},null,4),r("div",F,[y(u(e.parlamentar)+" ",1),r("small",null,"("+u(e.cargo)+")",1)]),m.value?.config.displayVotacao?(l(),n("div",M,[r("span",{class:j(d[p.value[e.id]?.voto]?.[0])},u(d[p.value[e.id]?.voto]?.[1]),3)])):v("",!0)]))),128)),(l(!0),n(g,null,O(A.value,e=>(l(),n("div",{key:`parlamentar-presente-${e.id}`,class:"parlamentar-presente"},[r("div",{class:"foto",style:N(`background-image: url(${k(e.id)})`)},null,4),r("div",w,u(e.__str__),1),m.value?.config.displayVotacao?(l(),n("div",D,[r("span",{class:j(d[p.value[e.id]?.voto]?.[0])},u(d[p.value[e.id]?.voto]?.[1]),3)])):v("",!0)]))),128)),m.value?.config.displayAusentes?(l(!0),n(g,{key:0},O(S.value,e=>(l(),n("div",{key:`parlamentar-ausente-${e.id}`,class:"parlamentar-ausente"},[r("div",{class:"foto",style:N(`background-image: url(${k(e.id)})`)},null,4),r("div",R,[y(u(e.__str__),1),t[0]||(t[0]=r("small",null," ",-1))]),m.value?.config.displayVotacao?(l(),n("div",U,[r("span",{class:j(d[p.value[e.id]?.voto]?.[0])},u(d[p.value[e.id]?.voto]?.[1]),3)])):v("",!0)]))),128)):v("",!0),r("div",W,[r("div",G,[r("div",L,[S.value.length>0?(l(),n(g,{key:0},[y(u(S.value.length)+" Ausentes ",1)],64)):v("",!0)]),r("div",Q,[t[1]||(t[1]=y(" Quórum ",-1)),r("span",H,u(B.value),1)])])])])]))}},ee=C(J,[["__scopeId","data-v-f64bfb3e"]]);export{ee as default};
