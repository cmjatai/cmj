import{z as p,c as b,N as H,C as N,o as S,f as a,g as o,k as t,q as l,j as $,A as m,F as B,r as F,n as A,i as h,t as f,m as D,R as E,E as L,l as O,S as M}from"./vendor-nrg9WaRj.js";import{_ as g,u as R}from"./main-DdU9x2R_.js";import"./vendor_fortawesome-8Bn9qoRt.js";const V={class:"chat-history-list"},j={class:"history-header"},z={class:"history-content"},T={key:0,class:"text-center p-3"},q={key:1,class:"text-center p-3 text-muted"},P={key:2,class:"list-group list-group-flush"},U=["onClick"],G={class:"d-flex w-100 justify-content-between"},J={class:"mb-1 text-truncate"},K={class:"text-nowrap"},Q={__name:"ChatHistoryList",setup(C){const u=N("EventBus"),i=E(),v=H(),n=p([]),r=p(!1),_=b(()=>v.params.sessionId),d=async()=>{r.value=!0;try{const s=await D.get("/api/search/chatsession/");n.value=s.data.results}catch(s){console.error("Erro ao carregar histórico:",s)}finally{r.value=!1}};u.on("chat:init:conversation",()=>{d()});const w=()=>{const s="session_"+Math.random().toString(36).substr(2,9);i.push({name:"chat_session_view",params:{sessionId:s}})},x=s=>{i.push({name:"chat_session_view",params:{sessionId:s}})},k=s=>{if(!s)return"";const e=new Date(s);return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}).format(e)};return S(()=>{d()}),(s,e)=>{const I=m("FontAwesomeIcon");return o(),a("div",V,[t("div",j,[e[1]||(e[1]=t("h4",null,"Histórico",-1)),t("button",{class:"btn btn-sm btn-outline-primary",onClick:w},[l(I,{icon:"plus"}),e[0]||(e[0]=$(" Nova Conversa ",-1))])]),t("div",z,[r.value?(o(),a("div",T,[...e[2]||(e[2]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Carregando...")],-1)])])):n.value.length===0?(o(),a("div",q,[...e[3]||(e[3]=[t("small",null,"Nenhuma conversa anterior.",-1)])])):(o(),a("ul",P,[(o(!0),a(B,null,F(n.value,c=>(o(),a("li",{key:c.session_id,class:A(["list-group-item list-group-item-action",{active:_.value===c.session_id}]),onClick:ot=>x(c.session_id)},[t("div",G,[t("h6",J,f(c.title),1),t("small",K,f(k(c.created_at)),1)]),h("",!0)],10,U))),128))]))])])}}},y=g(Q,[["__scopeId","data-v-64342a2d"]]),W={class:"chat-module-layout"},X={key:0,class:"chat-sidebar d-none d-md-block"},Y={class:"btn btn-primary d-md-none position-fixed m-3",style:{"z-index":"1050",bottom:"0",right:"0"},type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#chatHistoryOffcanvas","aria-controls":"chatHistoryOffcanvas"},Z={key:1,class:"offcanvas offcanvas-start d-md-none",tabindex:"-1",id:"chatHistoryOffcanvas","aria-labelledby":"chatHistoryOffcanvasLabel"},tt={class:"offcanvas-body p-0"},st={class:"chat-main-content"},et={__name:"ChatModule",setup(C){const u=R(),i=b(()=>u.hasPermission("search.can_use_chat_module"));return(v,n)=>{const r=m("FontAwesomeIcon"),_=m("router-view");return o(),a("div",W,[i.value?(o(),a("div",X,[l(y)])):h("",!0),t("button",Y,[l(r,{icon:"history"})]),i.value?(o(),a("div",Z,[n[0]||(n[0]=t("div",{class:"offcanvas-header"},[t("h5",{class:"offcanvas-title",id:"chatHistoryOffcanvasLabel"}," Histórico "),t("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1)),t("div",tt,[l(y)])])):h("",!0),t("div",st,[l(_,null,{default:L(({Component:d})=>[(o(),O(M(d)))]),_:1})])])}}},rt=g(et,[["__scopeId","data-v-30f4e13d"]]);export{rt as default};
