import{z as p,c as b,N as H,C as A,o as N,f as a,g as o,k as s,q as l,j as S,A as _,F as $,r as B,n as F,i as h,t as f,m as z,R as D,E,l as L,S as O}from"./vendor-nrg9WaRj.js";import{_ as g,u as M}from"./main-BdV1jcuf.js";import"./vendor_fortawesome-8Bn9qoRt.js";const R={class:"chat-history-list"},V={class:"history-header"},j={class:"history-content"},T={key:0,class:"text-center p-3"},U={key:1,class:"text-center p-3 text-muted"},q={key:2,class:"list-group list-group-flush"},P=["onClick"],G={class:"d-flex w-100 justify-content-between"},J={class:"mb-1 text-truncate"},K={class:"text-nowrap"},Q={__name:"ChatHistoryList",setup(C){const u=A("EventBus"),i=D(),v=H(),n=p([]),r=p(!1),m=b(()=>v.params.sessionId),d=async()=>{r.value=!0;try{const e=await z.get("/api/search/chatsession/");n.value=e.data.results}catch(e){console.error("Erro ao carregar histórico:",e)}finally{r.value=!1}};u.on("chat:init:conversation",()=>{d()});const x=()=>{const e="session_"+Math.random().toString(36).substr(2,9);i.push({name:"chat_session_view",params:{sessionId:e}})},w=e=>{i.push({name:"chat_session_view",params:{sessionId:e}})},k=e=>{if(!e)return"";const t=new Date(e);return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}).format(t)};return N(()=>{d()}),(e,t)=>{const I=_("FontAwesomeIcon");return o(),a("div",R,[s("div",V,[t[1]||(t[1]=s("h4",null,"Histórico",-1)),s("button",{class:"btn btn-sm btn-outline-primary",onClick:x},[l(I,{icon:"plus"}),t[0]||(t[0]=S(" Nova Conversa ",-1))])]),s("div",j,[r.value?(o(),a("div",T,[...t[2]||(t[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Carregando...")],-1)])])):n.value.length===0?(o(),a("div",U,[...t[3]||(t[3]=[s("small",null,"Nenhuma conversa anterior.",-1)])])):(o(),a("ul",q,[(o(!0),a($,null,B(n.value,c=>(o(),a("li",{key:c.session_id,class:F(["list-group-item list-group-item-action",{active:m.value===c.session_id}]),onClick:os=>w(c.session_id)},[s("div",G,[s("h6",J,f(c.title),1),s("small",K,f(k(c.created_at)),1)]),h("",!0)],10,P))),128))])),t[4]||(t[4]=s("div",{class:"p-3"},[s("small",{class:"text-muted"},[s("em",null," As respostas da IA podem estar incorretas ou desatualizadas. Utilize com cautela, para fins informativos. Confira sempre as fontes originais. ")])],-1))])])}}},y=g(Q,[["__scopeId","data-v-89039ed6"]]),W={class:"chat-module-layout"},X={key:0,class:"chat-sidebar d-none d-md-block"},Y={class:"btn btn-primary d-md-none position-fixed m-3",style:{"z-index":"1050",bottom:"0",right:"0"},type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#chatHistoryOffcanvas","aria-controls":"chatHistoryOffcanvas"},Z={key:1,class:"offcanvas offcanvas-start d-md-none",tabindex:"-1",id:"chatHistoryOffcanvas","aria-labelledby":"chatHistoryOffcanvasLabel"},ss={class:"offcanvas-body p-0"},ts={class:"chat-main-content"},es={__name:"ChatModule",setup(C){const u=M(),i=b(()=>u.hasPermission("search.can_use_chat_module"));return(v,n)=>{const r=_("FontAwesomeIcon"),m=_("router-view");return o(),a("div",W,[i.value?(o(),a("div",X,[l(y)])):h("",!0),s("button",Y,[l(r,{icon:"history"})]),i.value?(o(),a("div",Z,[n[0]||(n[0]=s("div",{class:"offcanvas-header"},[s("h5",{class:"offcanvas-title",id:"chatHistoryOffcanvasLabel"}," Histórico "),s("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1)),s("div",ss,[l(y)])])):h("",!0),s("div",ts,[l(m,null,{default:E(({Component:d})=>[(o(),L(O(d)))]),_:1})])])}}},rs=g(es,[["__scopeId","data-v-30f4e13d"]]);export{rs as default};
