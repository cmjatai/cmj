!function(a){function n(n){for(var t,r,c=n[0],s=n[1],d=n[2],p=0,u=[];p<c.length;p++)r=c[p],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(t in s)Object.prototype.hasOwnProperty.call(s,t)&&(a[t]=s[t]);for(l&&l(n);u.length;)u.shift()();return o.push.apply(o,d||[]),e()}function e(){for(var a,n=0;n<o.length;n++){for(var e=o[n],t=!0,c=1;c<e.length;c++){var s=e[c];0!==i[s]&&(t=!1)}t&&(o.splice(n--,1),a=r(r.s=e[0]))}return a}var t={},i={loa:0},o=[];function r(n){if(t[n])return t[n].exports;var e=t[n]={i:n,l:!1,exports:{}};return a[n].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=a,r.c=t,r.d=function(a,n,e){r.o(a,n)||Object.defineProperty(a,n,{enumerable:!0,get:e})},r.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},r.t=function(a,n){if(1&n&&(a=r(a)),8&n)return a;if(4&n&&"object"==typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&n&&"string"!=typeof a)for(var t in a)r.d(e,t,function(n){return a[n]}.bind(null,t));return e},r.n=function(a){var n=a&&a.__esModule?function(){return a.default}:function(){return a};return r.d(n,"a",n),n},r.o=function(a,n){return Object.prototype.hasOwnProperty.call(a,n)},r.p="/static/";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=n,c=c.slice();for(var d=0;d<c.length;d++)n(c[d]);var l=s;o.push([5,"chunk-vendors"]),e()}({5:function(a,n,e){a.exports=e("8930")},8930:function(a,n,e){"use strict";e.r(n),function(a,n){e("e260"),e("e6cf"),e("cca6"),e("a79d"),e("99af"),e("7db0"),e("caad"),e("a15b"),e("b0c0"),e("e9c4"),e("c1f9"),e("b64b"),e("d3b7"),e("ac1f"),e("2532"),e("a1f0"),e("5319"),e("5b81"),e("841c"),e("498a"),e("159b"),e("d02c");var t=e("cee4");t.a.defaults.xsrfCookieName="csrftoken",t.a.defaults.xsrfHeaderName="X-CSRFToken",window.AppLOA=function(){var e;if(!(this instanceof window.AppLOA))return e||(e=new window.AppLOA),e;e=this,window.AppLOA=function(){return e},e.LoaCRUD=function(){var n=a(".container-loa");n.hasClass("loa-detail")&&e.LoaCrudDETAIL(n)},e.LoaCrudDETAIL=function(a){},e.EmendaLoaCRUD=function(){var n=a(".container-loa");n.hasClass("emendaloa-update")?e.EmendaLoaCrudUPDATE(n):n.hasClass("emendaloa-list")&&e.EmendaLoaCrudLIST(n)},e.EmendaLoaCrudLIST=function(e){var t=e.find("form"),i=new FormData(t[0]),o=Object.fromEntries(i),r=JSON.stringify(o);if("{}"===r){var c=localStorage.getItem("portalcmj_emendaloa_filter"),s=JSON.parse(c);null!==c&&"{}"!==c&&(n.forOwn(s,(function(e,i){n.forEach(t.find('input[name="'.concat(i,'"]')),(function(n){(Array.isArray(e)&&e.includes(n.value)||e===n.value)&&(n.checked=!0,a('label[for="'.concat(n.id,'"] span')).addClass("active"))}))})),t.submit())}else localStorage.setItem("portalcmj_emendaloa_filter",r);var d=function(a){var n=new FormData(t[0]),e=n.getAll("parlamentares"),i=n.getAll("fase"),o=n.getAll("finalidade"),r=n.getAll("tipo"),c=o.length>0||r.length>0||i.length>0||e.length>0?{fase:i,parlamentares:e,tipo:r}:{},s=JSON.stringify(c);localStorage.setItem("portalcmj_emendaloa_filter",s),t.submit()};t.find('input[type="checkbox"]').change((function(a){d()})),t.find('input[type="text"]').change((function(a){d()}))},e.EmendaLoaCrudUPDATE=function(e){var i=window.location.href.matchAll(/emendaloa\/(\d+)\//g).next().value[1],o=e.find("form"),r="/api/loa/emendaloa/".concat(i),c=a(".container-preview").html('\n        <div class="inner-preview">\n          <a class="w-100" target="_blank" href="'.concat(r,'/view/">\n            <img src="').concat(r,"/view/?page=1&u=").concat(Date.now(),'"/>\n          </a>\n        </div>\n        <div class="btn-toolbar justify-content-between">\n          <div class="btn-group btn-group-sm">\n            <label for="id_lineHeight">\n              <span>Entrelinha (%)</span>\n              <input type="number"\n                name="lineHeight" value="150"\n                step="5"\n                min="100"\n                max="350"\n                class="numberinput form-control text-center"\n                id="id_lineHeight">\n            </label>\n          </div>\n        </div>\n      ')).find("img")[0];c.onload=function(a){c.style.opacity=1};var s=o.find(".registro-render");s.html(""),a('<div class="inner"></div>').appendTo(s),a('<div class="footer"></div>').appendTo(s);var d=function(){var e=s.find(".inner"),r=s.find(".footer");t.a.get("/api/loa/emendaloa/".concat(i,"/totais/")).then((function(n){r.html(""),a('\n            <div class="row">\n              <div class="col-12 totais">\n              TOTAIS:\n              </div>\n              <div class="col">\n                <span class="key">Inserções</span>\n                <span class="value">'.concat(n.data.soma_insercoes,'</span>\n              </div>\n              <div class="col">\n                <span class="key">Deduções</span>\n                <span class="value">').concat(n.data.soma_deducoes,'</span>\n              </div>\n              <div class="col text-').concat("0,00"===n.data.divergencia_registros?"blue":"red",'">\n                <span class="key">Inserções + Deduções</span>\n                <span class="value">').concat(n.data.divergencia_registros,'</span>\n              </div>\n              <div class="col text-').concat("0,00"===n.data.divergencia_emenda?"blue":"red",'">\n                <span class="key">Emenda - Inserções</span>\n                <span class="value">').concat(n.data.divergencia_emenda,"</span>\n              </div>\n            </div>\n            ")).appendTo(r)})),t.a.get("/api/loa/emendaloaregistrocontabil/?emendaloa=".concat(i,"&get_all=true")).then((function(i){n.each(i.data,(function(n,i){if(!(e.find('.item-rc[pk="'.concat(n.id,'"]')).length>0)){var r=a('<div class="item-rc" pk="'.concat(n.id,'"></div>'));r.appendTo(e);for(var c=n.__str__,s=c.search(/(\d) /g),l=0;s>0&&s<15&&l<20;)s=(c=c.replace(/^R\$/g,"R$ ")).search(/(\d) /g),l+=1;(c=c.split(" - "))[0]="<strong>".concat(c[0],"</strong>"),c=(c=c.join(" - ")).replaceAll(" ","&nbsp;"),a('<span class="texto">'.concat(c,"</span>")).appendTo(r),a('<span class="btn btn-sm btn-delete text-danger"><i class="far fa-trash-alt"></i></span>').appendTo(r).click((function(a){var n=a.target.closest(".item-rc").getAttribute("pk");t.a.delete("/api/loa/emendaloaregistrocontabil/".concat(n,"/")).then((function(n){o.trigger("change"),a.target.closest(".item-rc").remove(),d()}))}))}}))}))};d();var l=o.find('input[name="ano_loa"')[0].value,p=o.find(".busca-render"),u=o.find('input[name="busca_despesa"]'),f=o.find("#add_registro");f.click((function(e){var r=f[0].data;console.log(r);var c={};c.emendaloa=i,c.despesa=r,c.codigo=o.find('input[name="despesa_codigo"]').val(),c.orgao=o.find('input[name="despesa_orgao"]').val(),c.unidade=o.find('input[name="despesa_unidade"]').val(),c.especificacao=o.find('input[name="despesa_especificacao"]').val(),c.natureza=o.find('input[name="despesa_natureza"]').val(),c.valor=o.find('input[name="valor_despesa"]').val(),p.html("");var s=a('<div class="inner"></div>');t.a.post("/api/loa/emendaloaregistrocontabil/create_for_emendaloa_update/",c).then((function(n){f[0].data=null,o.find('input[name^="despesa_"], input[name$="_despesa"]').val("").attr("readonly",!1).removeClass("is-invalid"),a('<div class="alert alert-info>Registro de Despesa Adicionado com sucesso.</div>').appendTo(s),d(),o.trigger("change")})).catch((function(e){n.isString(e.response)||n.isString(e.response.data)?a('<div class="alert alert-danger">\n              '.concat(e.message,"\n              </div>")).appendTo(s):n.forOwn(e.response.data,(function(e,t){o.find("input[name=despesa_".concat(t,"], input[name=").concat(t,"_despesa]")).addClass("is-invalid"),a('<div class="alert alert-danger">\n              '.concat(n.isString(e)?e:e[0],"\n              </div>")).appendTo(s)}))})).finally((function(){s.appendTo(p)}))})),u.keyup((function(e){if(""===e.target.value.trim())return f[0].data=null,o.find('input[name^="despesa_"]').attr("readonly",!1),o.find('input[name^="despesa_"], input[name$="_despesa"]').removeClass("is-invalid"),void p.html("");t.a.get("/api/loa/despesaconsulta/search/?page_size=5&ano=".concat(l,"&q=").concat(e.target.value)).then((function(t){p.html("");var i=a('<div class="inner"></div>');i.appendTo(p),n.isEmpty(t.data.results)&&(f[0].data=null,o.find('input[name^="despesa_"]').attr("readonly",!1),a('<div class="alert alert-warning">\n              Nenhuma despesa encontrada nos anexos da LOA com esta informação. Você pode ainda fazer o registro manualmente no formulário acima.\n            </div>').appendTo(i));var r=e.target.value.trim().split(" ");n.each(t.data.results,(function(e,t){var c="\n                Órgão...: ".concat(e.cod_orgao," - ").concat(e.esp_orgao,"<br>\n                Und Orç.: ").concat(e.cod_unidade," - ").concat(e.esp_unidade,"<br>\n                Código..: ").concat(e.codigo," - ").concat(e.especificacao,"<br>\n                Natureza: ").concat(e.cod_natureza," - ").concat(e.esp_natureza,"<br>\n                Val.Orç.: ").concat(e.str_valor," | Saldo: ").concat(e.str_saldo);n.each(r,(function(a,n){c=c.replaceAll(a.toUpperCase(),'<strong class="text-blue">'.concat(a.toUpperCase(),"</strong>"))}));var s='<div class="small item" pk="'.concat(e.id,'">\n                ').concat(c,"\n              </div>");a(s).appendTo(i).click((function(a){o.find('input[name="despesa_codigo"]').val(e.codigo),o.find('input[name="despesa_orgao"]').val(e.cod_orgao),o.find('input[name="despesa_unidade"]').val(e.cod_unidade),o.find('input[name="despesa_especificacao"]').val(e.especificacao),o.find('input[name="despesa_natureza"]').val(e.cod_natureza),o.find('input[name^="despesa_"]').attr("readonly",!0);var n=a.currentTarget.getAttribute("pk");f[0].data=n,p.html("")}))}))})).catch((function(){}))})),o.keypress((function(a){if(13===a.keyCode){if(a.preventDefault(),a.target===u[0]){var n=p.find(".inner").children();1===n.length&&n.trigger("click")}return!1}})),o.find('select[name="fase"]').change((function(a){var n=a.target;"10"===n.value?n.classList.add("is-invalid"):n.classList.remove("is-invalid")})),o.change((function(a){var n={},e=a.target.name,i=a.target.value,s="/";c.style.opacity=.35;var l=a.target.getAttribute("parlamentar_id");if(null!==l)n.valor=i,n.parlamentar_id=l,s="/updatevalorparlamentar/";else{if("lineHeight"===e)return void(c.src="".concat(r,"/view/?page=1&lineHeight=").concat(i,"&u=").concat(Date.now()));n[e]=i}t.a.patch("".concat(r).concat(s),n).then((function(a){o.find('input[name="lineHeight"]').val(a.data.metadata.style.lineHeight),o.find('input[name="valor"]').val(a.data.valor),d(),c.src="".concat(r,"/view/?page=1&u=").concat(Date.now())})).catch((function(a){}))})),o.trigger("change")},e.AgrupamentoCRUD=function(){var n=a(".container-loa");n.hasClass("agrupamento-update")&&e.AgrupamentoCrudUPDATE(n)},e.AgrupamentoCrudUPDATE=function(e){var i=window.location.href.matchAll(/agrupamento\/(\d+)\//g).next().value[1],o=e.find("form"),r="/api/loa/agrupamento/".concat(i),c=o.find(".registro-render");c.html(""),a('<div class="inner"></div>').appendTo(c),a('<div class="footer"></div>').appendTo(c);var s=function(){var e=c.find(".inner");t.a.get("/api/loa/agrupamentoregistrocontabil/?agrupamento=".concat(i,"&get_all=true")).then((function(i){n.each(i.data,(function(n,i){if(!(e.find('.item-rc[pk="'.concat(n.id,'"]')).length>0)){var r=a('<div class="item-rc" pk="'.concat(n.id,'"></div>'));r.appendTo(e);for(var c=n.__str__,d=c.search(/(\d)%/g),l=0;d>0&&d<6&&l<10;)d=(c=" "+c).search(/(\d)%/g),l+=1;(c=c.split(" - "))[0]="<strong>".concat(c[0],"</strong>"),c=(c=c.join(" - ")).replaceAll(" ","&nbsp;"),a('<span class="texto">'.concat(c,"</span>")).appendTo(r),a('<span class="btn btn-sm btn-delete text-danger"><i class="far fa-trash-alt"></i></span>').appendTo(r).click((function(a){var n=a.target.closest(".item-rc").getAttribute("pk");t.a.delete("/api/loa/agrupamentoregistrocontabil/".concat(n,"/")).then((function(n){o.trigger("change"),a.target.closest(".item-rc").remove(),s()}))}))}}))}))};s();var d=o.find('input[name="ano_loa"')[0].value,l=o.find(".busca-render"),p=o.find('input[name="busca_despesa"]'),u=o.find("#add_registro");u.click((function(e){var r=u[0].data;console.log(r);var c={};c.agrupamento=i,c.despesa=r,c.codigo=o.find('input[name="despesa_codigo"]').val(),c.orgao=o.find('input[name="despesa_orgao"]').val(),c.unidade=o.find('input[name="despesa_unidade"]').val(),c.especificacao=o.find('input[name="despesa_especificacao"]').val(),c.natureza=o.find('input[name="despesa_natureza"]').val(),c.percentual=o.find('input[name="perc_despesa"]').val(),l.html("");var d=a('<div class="inner"></div>');t.a.post("/api/loa/agrupamentoregistrocontabil/create_for_agrupamento_update/",c).then((function(n){u[0].data=null,o.find('input[name^="despesa_"], input[name$="_despesa"]').val("").attr("readonly",!1).removeClass("is-invalid"),o.find('input[name="perc_despesa"]').val("100,00"),a('<div class="alert alert-info>Registro de Despesa Adicionado com sucesso.</div>').appendTo(d),s(),o.trigger("change")})).catch((function(e){n.isString(e.response)||n.isString(e.response.data)?a('<div class="alert alert-danger">\n              '.concat(e.message,"\n              </div>")).appendTo(d):n.forOwn(e.response.data,(function(e,t){o.find("input[name=despesa_".concat(t,"], input[name=").concat(t,"_despesa]")).addClass("is-invalid"),a('<div class="alert alert-danger">\n              '.concat(n.isString(e)?e:e[0],"\n              </div>")).appendTo(d)}))})).finally((function(){d.appendTo(l)}))})),p.keyup((function(e){if(o.find('input[name^="despesa_"], input[name$="_despesa"]').removeClass("is-invalid"),""===e.target.value.trim())return u[0].data=null,o.find('input[name^="despesa_"]').attr("readonly",!1),void l.html("");t.a.get("/api/loa/despesaconsulta/search/?page_size=5&ano=".concat(d,"&q=").concat(e.target.value)).then((function(t){l.html("");var i=a('<div class="inner"></div>');i.appendTo(l),n.isEmpty(t.data.results)&&(u[0].data=null,o.find('input[name^="despesa_"]').attr("readonly",!1),a('<div class="alert alert-warning">\n              Nenhuma despesa encontrada nos anexos da LOA com esta informação. Você pode ainda fazer o registro manualmente no formulário acima.\n            </div>').appendTo(i));var r=e.target.value.trim().split(" ");n.each(t.data.results,(function(e,t){var c="\n                Órgão...: ".concat(e.cod_orgao," - ").concat(e.esp_orgao,"<br>\n                Und Orç.: ").concat(e.cod_unidade," - ").concat(e.esp_unidade,"<br>\n                Código..: ").concat(e.codigo," - ").concat(e.especificacao,"<br>\n                Natureza: ").concat(e.cod_natureza," - ").concat(e.esp_natureza,"<br>\n                Val.Orç.: ").concat(e.str_valor," | Saldo: ").concat(e.str_saldo);n.each(r,(function(a,n){c=c.replaceAll(a.toUpperCase(),'<strong class="text-blue">'.concat(a.toUpperCase(),"</strong>"))}));var s='<div class="small item" pk="'.concat(e.id,'">\n                ').concat(c,"\n              </div>");a(s).appendTo(i).click((function(a){o.find('input[name="despesa_codigo"]').val(e.codigo),o.find('input[name="despesa_orgao"]').val(e.cod_orgao),o.find('input[name="despesa_unidade"]').val(e.cod_unidade),o.find('input[name="despesa_especificacao"]').val(e.especificacao),o.find('input[name="despesa_natureza"]').val(e.cod_natureza),o.find('input[name^="despesa_"]').attr("readonly",!0);var n=a.currentTarget.getAttribute("pk");u[0].data=n,l.html("")}))}))})).catch((function(){}))}));var f=o.find(".emendaloa-selecteds"),v=o.find(".busca-render-emendaloa"),g=o.find('input[name="busca_emendaloa"]'),m=function(){t.a.get("/api/loa/agrupamento/".concat(i,"/emendas/?&get_all=true")).then((function(e){f.html("");var o=a('<div class="inner"></div>');o.appendTo(f),n.each(e.data,(function(n,e){var r=a('<div class="inner-item"></div>').appendTo(o);a('<div class="item-emendaloa" pk="'.concat(n.id,'">\n              <strong>Valor da Emenda Impositiva: R$ ').concat(n.str_valor,"</strong><br>\n              <strong>").concat(n.indicacao,'</strong><br>\n              <a href="').concat(n.link_detail_backend,'/edit" target="_blank">').concat(n.finalidade,"</a><br>\n              ").concat(n.str_parlamentares.join("<br>"),'\n              <span class="fase ').concat(10===n.fase?"bg-danger":12===n.fase?"bg-warning":"bg-green",'">').concat(n.str_fase,"</span>\n              </div>")).appendTo(r);var c=a('<div class="inner-actions"></div>').appendTo(r);a('<span class="btn btn-delete text-danger" pk="'.concat(n.id,'" title="Remover Emenda do Agrupamento."><i class="far fa-trash-alt"></i></span>')).appendTo(c).click((function(n){var e=n.currentTarget.getAttribute("pk"),r={};r.agrupamento=i,r.emendaloa=e,t.a.post("/api/loa/agrupamentoemendaloa/delete/",r).then((function(a){m()})).catch((function(n){v.find(".alert").remove(),o.prepend(a('<div class="alert alert-danger">\n                    '.concat(n.message,"\n                    </div>")))}))}))}))}))};m(),g.keyup((function(e){e.ctrlKey||(""!==e.target.value.trim()?e.target.value.trim().length<3?v.html("Digite ao menos três letras"):t.a.get("/api/loa/emendaloa/search/?&get_all=true&ano=".concat(d,"&q=").concat(e.target.value)).then((function(e){v.html("");var o=a('<div class="inner"></div>');o.appendTo(v),n.each(e.data,(function(n,e){if(!(f.find('.item-emendaloa[pk="'.concat(n.id,'"]')).length>0)){var r=a('<div class="inner-item"></div>').appendTo(o);if(a('<div class="item-emendaloa" pk="'.concat(n.id,'">\n                <strong>Valor da Emenda Impositiva: R$ ').concat(n.str_valor,"</strong><br>\n                <strong>").concat(n.indicacao,'</strong><br>\n                <a href="').concat(n.link_detail_backend,'/edit" target="_blank">').concat(n.finalidade,"</a><br>\n                ").concat(n.str_parlamentares.join("<br>"),'<br>\n                <span class="fase ').concat(10===n.fase?"bg-danger":12===n.fase?"bg-warning":"bg-green",'">').concat(n.str_fase,"</span>\n              </div>")).appendTo(r),10!==n.fase){var c=a('<div class="inner-actions"></div>').appendTo(r);a('<span class="btn text-blue" pk="'.concat(n.id,'" title="Adicionar Emenda ao Agrupamento."><i class="far fa-arrow-alt-circle-right"></i></i></span>')).appendTo(c).click((function(n){var e=n.currentTarget.getAttribute("pk"),r={};r.agrupamento=i,r.emendaloa=e,r.emendaloa__fase=15,t.a.post("/api/loa/agrupamentoemendaloa/",r).then((function(a){v.find('.item-emendaloa[pk="'.concat(a.data.emendaloa,'"]')).parent().remove(),m()})).catch((function(n){v.find(".alert").remove(),o.prepend(a('<div class="pt-2"><div class="alert alert-danger">\n                    '.concat(n.response.data[0],"\n                    </div></div>")))}))}))}}}))})):v.html(""))})),o.keypress((function(a){if(13===a.keyCode){if(a.preventDefault(),a.target===p[0]){var n=l.find(".inner").children();1===n.length&&n.trigger("click")}return!1}})),o.find('select[name="fase"]').change((function(a){var n=a.target;"10"===n.value?n.classList.add("is-invalid"):n.classList.remove("is-invalid")})),o.change((function(a){var n={},e=a.target.name,i=a.target.value;n[e]=i,t.a.patch("".concat(r).concat("/"),n).then((function(a){s()})).catch((function(a){}))})),o.trigger("change")},e.init=function(){e.LoaCRUD(),e.EmendaLoaCRUD(),e.AgrupamentoCRUD()},e.init()},a(document).ready((function(){a(".container-loa").length>0&&window.AppLOA()}))}.call(this,e("1157"),e("2ef0"))},d02c:function(a,n,e){}});