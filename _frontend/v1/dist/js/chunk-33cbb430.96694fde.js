(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-33cbb430"],{1245:function(e,a,t){},"811b":function(e,a,t){"use strict";t("1245")},"8da4":function(e,a,t){"use strict";(function(e){var s=t("2909"),o=(t("99af"),t("4de4"),t("caad"),t("a15b"),t("d81d"),t("14d9"),t("fb6a"),t("e9f5"),t("910d"),t("a9e3"),t("d3b7"),t("25f0"),t("2532"),t("4d90"),t("37bc")),c=t("ac27"),n=t("7f10"),r=t("e2c1");a.a={name:"LoaDetail",components:{BarChart:n.a,DoughnutChart:c.a,ModelSelect:o.a},data:function(){return{loa:{id:this.$route.params.pkloa},espelho:null,chartDataLoa:null,chartDataHist:null,chartDataExec:null,data_exec:null,height:450,pluginsExec:[{title:{display:!0,text:""}}],pluginsBar:[{title:{display:!0,text:""}}],pluginsDun:[{title:{display:!0,text:""}}],despesas_agrupadas:[],despesa:{orgaoselected:null,unidadeselected:null,funcaoselected:null,subfuncaoselected:null,programaselected:null,acaoselected:null,agrupamentoselected:"funcao",itensselected:20},filters:["orgaoselected","unidadeselected","funcaoselected","subfuncaoselected","programaselected","acaoselected"],agrupamentos:{orgao:"Órgãos",unidade:"Unidades Orçamentárias",funcao:"Funções",subfuncao:"SubFunções",programa:"Programas",acao:"Ações",natureza_1:"Natureza - Nível 1",natureza_2:"Natureza - Nível 2",natureza_3:"Natureza - Nível 3",natureza_4:"Natureza - Nível 4",natureza_5:"Natureza - Nível 5",fonte:"Fonte de Recurso"},tipos_agrups:["orgao","unidade","funcao","subfuncao","programa","acao","natureza_1","natureza_2","natureza_3","natureza_4","natureza_5","fonte"],itens:[{value:5,text:"05 Maiores"},{value:10,text:"10 Maiores"},{value:15,text:"15 Maiores"},{value:20,text:"20 Maiores"},{value:25,text:"25 Maiores"},{value:999,text:"Todos os Itens"}],itens_hist:[{value:5,text:"05 Itens"},{value:10,text:"10 Itens"},{value:15,text:"15 Itens"},{value:20,text:"20 Itens"}],barchart_exec_offset:0,barchart_exec_length:0,barchart_offset:0,barchart_length:0,barchart_max_items__select:5,barchart_max_items:5,barchart_colors:this.build_colors(20,"a0")}},computed:{qs_loa:function(){var e=this.loa.id;return e?"&loa=".concat(e,"&despesa_set__isnull=False"):""},qs_orgao:function(){var e=this.despesa.orgaoselected;return e&&e.id?"&orgao=".concat(e.id):""},agrupamentos__options:function(){var a=[];return e.forOwn(this.agrupamentos,(function(e,t){a.push({text:e,value:t})})),a},despesas_agrupadas_table:function(){var a=[],t=e.orderBy(e.filter(this.despesas_agrupadas,(function(e){return e.alt})),["codigo"]);return e.each(t,(function(e,t){a.push({"Código":e.codigo,"Especificação":e.especificacao,"Valor no Orçamento":e.vm_str,"Emendas Imposititivas":e.alt_str,"Saldo Final":e.saldo_str})})),a}},watch:{barchart_max_items__select:{handler:function(e,a){this.barchart_exec_offset=0,this.barchart_offset=0,this.barchart_max_items=Number(e),this.fetch("",1)}},"despesa.orgaoselected":{deep:!0,immediate:!0,handler:function(e,a){var t=this;(a||e)&&a!==e&&t.$nextTick().then((function(){t.tipos_agrups.indexOf(t.despesa.agrupamentoselected)<t.tipos_agrups.indexOf("unidade")&&(t.despesa.agrupamentoselected="unidade"),t.fetch()}))}},"despesa.unidadeselected":{deep:!0,immediate:!0,handler:function(e,a){var t=this;(a||e)&&a!==e&&t.$nextTick().then((function(){t.tipos_agrups.indexOf(t.despesa.agrupamentoselected)<t.tipos_agrups.indexOf("funcao")&&(t.despesa.agrupamentoselected="funcao"),t.fetch()}))}},"despesa.funcaoselected":{deep:!0,immediate:!0,handler:function(e,a){var t=this;(a||e)&&a!==e&&t.$nextTick().then((function(){t.tipos_agrups.indexOf(t.despesa.agrupamentoselected)<t.tipos_agrups.indexOf("subfuncao")&&(t.despesa.agrupamentoselected="subfuncao"),t.fetch()}))}},"despesa.subfuncaoselected":{deep:!0,immediate:!0,handler:function(e,a){var t=this;(a||e)&&a!==e&&t.$nextTick().then((function(){t.tipos_agrups.indexOf(t.despesa.agrupamentoselected)<t.tipos_agrups.indexOf("programa")&&(t.despesa.agrupamentoselected="programa"),t.fetch()}))}},"despesa.programaselected":{deep:!0,immediate:!0,handler:function(e,a){var t=this;(a||e)&&a!==e&&t.$nextTick().then((function(){t.tipos_agrups.indexOf(t.despesa.agrupamentoselected)<t.tipos_agrups.indexOf("acao")&&(t.despesa.agrupamentoselected="acao"),t.fetch()}))}},"despesa.acaoselected":{deep:!0,immediate:!0,handler:function(e,a){var t=this;(a||e)&&a!==e&&t.$nextTick().then((function(){t.tipos_agrups.indexOf(t.despesa.agrupamentoselected)<t.tipos_agrups.indexOf("natureza_1")&&(t.despesa.agrupamentoselected="natureza_5"),t.fetch()}))}},"despesa.agrupamentoselected":{deep:!0,immediate:!0,handler:function(e,a){var t=this;(a||e)&&a!==e&&t.$nextTick().then((function(){t.fetch()}))}},"despesa.itensselected":{deep:!0,immediate:!0,handler:function(e,a){var t=this;t.$nextTick().then((function(){(a||e)&&a!==e&&t.fetch()}))}}},methods:{clearFilters:function(e){this.despesa={orgaoselected:null,unidadeselected:null,funcaoselected:null,subfuncaoselected:null,programaselected:null,acaoselected:null,agrupamentoselected:"funcao",itensselected:20}},clickSlice:function(e,a){"hist"===a?(-1===e&&this.barchart_offset>0||1===e&&this.barchart_offset+this.barchart_max_items<this.barchart_length)&&(this.barchart_offset+=e,this.fetch("",1)):(-1===e&&this.barchart_exec_offset>0||1===e&&this.barchart_exec_offset+this.barchart_max_items<this.barchart_exec_length)&&(this.barchart_exec_offset+=e,this.fetch("",1))},handleResize:function(){},fetch:function(){var a=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this,c={orgao:o.despesa.orgaoselected?o.despesa.orgaoselected.codigo:null,unidade:o.despesa.unidadeselected?"".concat(o.despesa.unidadeselected.codigo,"/").concat(o.despesa.unidadeselected.orgao):null,funcao:o.despesa.funcaoselected?o.despesa.funcaoselected.codigo:null,subfuncao:o.despesa.subfuncaoselected?o.despesa.subfuncaoselected.codigo:null,programa:o.despesa.programaselected?o.despesa.programaselected.codigo:null,acao:o.despesa.acaoselected?o.despesa.acaoselected.codigo:null,agrupamento:""===t?o.despesa.agrupamentoselected:t,itens:o.despesa.itensselected};o.$nextTick().then((function(){if(0!==s)return a;o.barchart_offset=0,o.barchart_exec_offset=0,c.hist=s,o.utils.postModelAction("loa","loa",o.loa.id,"despesas_agrupadas",c).then((function(a){var s=[],n=o.build_colors(a.data.length),r=[];e.each(a.data,(function(e,a){s.push("".concat(e.vm_str," / ").concat(e.codigo,"-").concat(e.especificacao)),r.push(e.vm)}));var i={labels:s,datasets:[{data:r,backgroundColor:n,hoverOffset:50}]};if(null!==o.chartDataLoa){o.$set(o.chartDataLoa,"labels",s),o.$set(o.chartDataLoa.datasets,""===t?0:1,{data:r,backgroundColor:n,hoverOffset:50});var l=["ORÇAMENTO DE ".concat(o.loa.ano," DO MUNICÍPIO DE JATAÍ")],d=[];e.forOwn(o.despesa,(function(e,a){o.filters.includes(a)&&null!==e&&d.push(e.especificacao)})),e.isEmpty(d)||l.push("FILTRADO POR: ".concat(d.join(" / "))),l.push("Orçamento das despesas agrupadas por: ".concat(o.agrupamentos[c.agrupamento])),e.isEmpty(r)?l.push("Sem dados para mostrar"):l.push("R$ ".concat(a.data.length>0?a.data[0].vm_soma:"0,00",".")),o.$set(o.pluginsDun,0,{title:{display:!0,text:l}})}else o.chartDataLoa=i})).then((function(e){a.handleResize()})).catch((function(e){return o.sendMessage({alert:"danger",message:"Não foi possível recuperar a lista...",time:5})}))})).then((function(){o.utils.postModelAction("loa","loa",o.loa.id,"espelho",c).then((function(e){o.espelho=e.data}))})).then((function(){o.utils.getModelAction("loa","loa",o.loa.id,"despesas_executadas").then((function(a){o.data_exec=a.data;var t=o.barchart_colors,s=[],c=[],n=[],r=[];e.each(a.data,(function(e,a){s.push("".concat(e[0]," - ").concat(e[1])),c.push(e[2]),n.push(e[3]),r.push(e[4])})),o.barchart_exec_length=s.length,s=s.slice(o.barchart_exec_offset,o.barchart_exec_offset+o.barchart_max_items);var i=[{label:"Despesas Orçamentárias",data:c.slice(o.barchart_exec_offset,o.barchart_exec_offset+o.barchart_max_items),backgroundColor:t[0]},{label:"Despesas Executadas",data:n.slice(o.barchart_exec_offset,o.barchart_exec_offset+o.barchart_max_items),backgroundColor:t[1]},{label:"Receita Arrecadada",data:r.slice(o.barchart_exec_offset,o.barchart_exec_offset+o.barchart_max_items),backgroundColor:t[2]}],l={labels:s,datasets:i};if(null!==o.chartDataExec){var d=["ORÇAMENTO vs EXECUÇÃO - ".concat(o.loa.ano)];o.$set(o.chartDataExec,"labels",s),o.$set(o.chartDataExec,"datasets",i),o.$set(o.pluginsExec,0,{title:{display:!0,text:d}})}else o.chartDataExec=l})).then((function(e){a.handleResize()})).catch((function(e){}))}))},build_colors:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=[];if(e<1)return t;for(var o=Math.floor(360*Math.random()),c=function(e,a,t){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a*Math.min(t,1-t),o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(a+e/30)%12;return t-s*Math.max(Math.min(o-3,9-o,1),-1)};return[o(0),o(8),o(4)]},n=function(e,a,t){return"#"+[e,a,t].map((function(e){return Math.round(255*e).toString(16).padStart(2,0)})).join("")},r=0;r<e;r++){var i="".concat(n.apply(void 0,Object(s.a)(c(o,Math.max(.8,Math.random()),.4))));o=(o+(30*Math.random()+(o<150?50:25)))%360,t.push("".concat(i).concat(a))}return t},build_colors_hsl:function(e){var a=[];if(e<1)return a;for(var t=Math.floor(360*Math.random()),s=0;s<e;s++){var o="hsl( "+t+", 100%, 40%)";t=(t+(30*Math.random()+(t<150?50:25)))%360,a.push(o)}return a},build_colors_random:function(e){for(var a=[],t=0;t<e;t++){for(var s="#",o=0;o<6;o++)s+="0123456789ABCDEF"[Math.floor(Math.random()*(o%2==0?14:16))];a.push(s)}return a}},mounted:function(){var e=this;e.$nextTick().then((function(){e.utils.getModel("loa","loa",e.loa.id).then((function(a){var t=r.a.load(a.data.yaml_obs);a.data.yaml_obs=t,e.loa=a.data}))}))}}}).call(this,t("2ef0"))},ac27:function(e,a,t){"use strict";t("d81d"),t("fb6a"),t("e9f5"),t("7d54"),t("ab43"),t("a9e3"),t("b680"),t("d3b7"),t("159b");var s=t("7b97"),o=t("d9fa"),c=t("dd61");c.f.register(c.p,c.q,c.h,o.a,c.a,c.e);var n={name:"DoughnutChart",components:{Doughnut:s.b},props:{chartId:{type:String,default:"doughnut-chart"},chartDataUser:{type:Object,default:function(){}},datasetIdKey:{type:String,default:"label"},width:{type:Number,default:1140},height:{type:Number,default:500},cssClasses:{default:"",type:String},styles:{type:Object,default:function(){}},plugins:{type:Array,default:function(){return[]}}},data:function(){return{chartData:null,chartOptions:{responsive:!0,maintainAspectRatio:!1,layout:{padding:15},onHover:function(e){},plugins:{title:{display:!0,text:"",padding:{top:-15,bottom:20}},legend:{position:"left",onHover:this.handleHover,onLeave:this.handleLeave,onClick:this.handleClick,labels:{font:{family:"'Courier New', Courier, monospace",size:15},padding:2}},datalabels:{formatter:function(e,a){var t=a.dataset.data,s=0;return t.map((function(e){s+=e})),(e/s*100).toFixed(1)+"%"},color:"#fff"}}}}},watch:{plugins:function(e,a){this.chartOptions.plugins.title.text=e[0].title.text}},methods:{handleClick:function(e,a,t){},handleHover:function(e,a,t){t.chart.data.datasets[0].backgroundColor.forEach((function(e,t,s){s[t]=t===a.index||9===e.length?e:e+"3d"})),t.chart.update()},handleLeave:function(e,a,t){t.chart.data.datasets[0].backgroundColor.forEach((function(e,a,t){t[a]=9===e.length?e.slice(0,-2):e})),t.chart.update()}},mounted:function(){this.chartOptions.plugins.title.text=this.plugins[0].title.text,this.chartData=this.chartDataUser}},r=t("2877"),i=Object(r.a)(n,(function(){var e=this,a=e._self._c;return e.chartData?a("Doughnut",{attrs:{"chart-options":e.chartOptions,"chart-data":e.chartData,"chart-id":e.chartId,"dataset-id-key":e.datasetIdKey,plugins:e.plugins,"css-classes":e.cssClasses,styles:e.styles,width:e.width,height:e.height}}):e._e()}),[],!1,null,null,null);a.a=i.exports},cd0f:function(e,a,t){"use strict";t.r(a);t("99af");var s=t("8da4").a,o=(t("811b"),t("2877")),c=Object(o.a)(s,(function(){var e=this,a=e._self._c;return a("div",{staticClass:"vue-loa-detail"},[e.loa.ano&&e.chartDataLoa?e._e():a("div",{staticClass:"container"},[a("strong",{staticClass:"d-block mx-5 my-5"},[e._v("Carregando Dados Gráficos...")])]),e.loa.ano&&e.chartDataLoa?a("div",{staticClass:"container"},[e._m(0),a("div",{staticClass:"row c-fields"},[a("div",{staticClass:"col-md-3"},[e._v(" Órgãos "),a("model-select",{ref:"orgaoSelect",attrs:{app:"loa",model:"orgao",choice:"__str__",ordering:"codigo",required:!1,extra_query:"&loa=".concat(e.qs_loa)},on:{change:function(a){return e.despesa.orgaoselected=a}},model:{value:e.despesa.orgaoselected,callback:function(a){e.$set(e.despesa,"orgaoselected",a)},expression:"despesa.orgaoselected"}}),e._v(" Unidades Orçamentárias "),a("model-select",{ref:"unidadeSelect",attrs:{app:"loa",model:"unidadeorcamentaria",choice:"__str__",ordering:"codigo",required:!1,extra_query:"".concat(e.qs_loa).concat(e.qs_orgao)},on:{change:function(a){return e.despesa.unidadeselected=a}},model:{value:e.despesa.unidadeselected,callback:function(a){e.$set(e.despesa,"unidadeselected",a)},expression:"despesa.unidadeselected"}})],1),a("div",{staticClass:"col-md-3"},[e._v(" Funções "),a("model-select",{ref:"funcaoSelect",attrs:{app:"loa",model:"funcao",choice:"__str__",ordering:"codigo",required:!1,extra_query:"".concat(e.qs_loa)},on:{change:function(a){return e.despesa.funcaoselected=a}},model:{value:e.despesa.funcaoselected,callback:function(a){e.$set(e.despesa,"funcaoselected",a)},expression:"despesa.funcaoselected"}}),e._v(" Subfunções "),a("model-select",{ref:"subfuncaoSelect",attrs:{app:"loa",model:"subfuncao",choice:"__str__",ordering:"codigo",required:!1,extra_query:"".concat(e.qs_loa)},on:{change:function(a){return e.despesa.subfuncaoselected=a}},model:{value:e.despesa.subfuncaoselected,callback:function(a){e.$set(e.despesa,"subfuncaoselected",a)},expression:"despesa.subfuncaoselected"}})],1),a("div",{staticClass:"col-md-3"},[e._v(" Programas "),a("model-select",{ref:"programaSelect",attrs:{app:"loa",model:"programa",choice:"__str__",ordering:"codigo",required:!1,extra_query:"".concat(e.qs_loa)},on:{change:function(a){return e.despesa.programaselected=a}},model:{value:e.despesa.programaselected,callback:function(a){e.$set(e.despesa,"programaselected",a)},expression:"despesa.programaselected"}}),e._v(" Ações "),a("model-select",{ref:"acaoSelect",attrs:{app:"loa",model:"acao",choice:"__str__",ordering:"codigo",required:!1,extra_query:"".concat(e.qs_loa)},on:{change:function(a){return e.despesa.acaoselected=a}},model:{value:e.despesa.acaoselected,callback:function(a){e.$set(e.despesa,"acaoselected",a)},expression:"despesa.acaoselected"}})],1),a("div",{staticClass:"col-md-1"}),a("div",{staticClass:"col-md-2 c-groups"},[a("div",{},[a("strong",[e._v("Agrupamentos")]),a("b-form-select",{attrs:{options:e.agrupamentos__options,"select-size":1},model:{value:e.despesa.agrupamentoselected,callback:function(a){e.$set(e.despesa,"agrupamentoselected",a)},expression:"despesa.agrupamentoselected"}})],1),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("strong",[e._v("Máximo de Itens")]),a("b-form-select",{attrs:{options:e.itens,"select-size":1},model:{value:e.despesa.itensselected,callback:function(a){e.$set(e.despesa,"itensselected",a)},expression:"despesa.itensselected"}})],1),a("div",{staticClass:"col-6"},[a("strong",[e._v("Histograma")]),a("b-form-select",{attrs:{options:e.itens_hist,"select-size":1},model:{value:e.barchart_max_items__select,callback:function(a){e.barchart_max_items__select=a},expression:"barchart_max_items__select"}})],1)]),a("div",{staticClass:"col mt-1 text-right"},[a("b-button",{staticClass:"bg-secondary",attrs:{size:"sm"},on:{click:function(a){return e.clearFilters(e.event)}}},[e._v("Limpar Pesquisa")])],1)])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 container-doughnut p-3 mt-3"},[e.chartDataLoa?a("DoughnutChart",{attrs:{height:e.height,plugins:e.pluginsDun,chartDataUser:e.chartDataLoa}}):e._e(),a("b-table",{staticClass:"local_table",attrs:{striped:"",hover:"",items:e.despesas_agrupadas_table}})],1),a("div",{staticClass:"col-12 mt-3",domProps:{innerHTML:e._s(e.loa.yaml_obs&&e.loa.yaml_obs.GRAFICO_DESPESAS_MATERIA?e.loa.yaml_obs.GRAFICO_DESPESAS_MATERIA:"")}}),e.espelho?a("div",{staticClass:"col-12 mt-3"},[a("table",{staticClass:"table table-sm table-bordered table-striped table_espelho"},[e._m(1),a("tbody",e._l(e.espelho,(function(t,s){return a("tr",{key:s},[a("td",{domProps:{innerHTML:e._s(t[0]+" - "+t[3])}}),a("td",{domProps:{innerHTML:e._s(t[2])}})])})),0)])]):e._e(),e.chartDataHist?a("div",{staticClass:"col-12 container-barchart p-3 mt-3"},[a("div",{staticClass:"btn-barchart-left",on:{click:function(a){return e.clickSlice(-1,"hist")}}},[a("i",{staticClass:"fa fa-chevron-left"})]),a("div",{staticClass:"btn-barchart-right",on:{click:function(a){return e.clickSlice(1,"hist")}}},[a("i",{staticClass:"fa fa-chevron-right"})]),a("BarChart",{attrs:{plugins:e.pluginsBar,chartDataUser:e.chartDataHist,cssClasses:"barchart-component"}})],1):e._e(),e.chartDataExec?a("div",{staticClass:"col-12 container-barchart p-3 mt-3"},[a("div",{staticClass:"btn-barchart-left",on:{click:function(a){return e.clickSlice(-1,"exec")}}},[a("i",{staticClass:"fa fa-chevron-left"})]),a("div",{staticClass:"btn-barchart-right",on:{click:function(a){return e.clickSlice(1,"exec")}}},[a("i",{staticClass:"fa fa-chevron-right"})]),a("BarChart",{attrs:{plugins:e.pluginsExec,chartDataUser:e.chartDataExec,cssClasses:"barchart-2"}}),a("div",{staticClass:"fonte small pt-5"},[e._v(" FONTE: Os dados são extraídos no período noturno dos portais de transparência do "),a("a",{attrs:{href:"http://prefeituradejatai.sigepnet.com.br"}},[e._v("Poder Executivo")]),e._v(" e do "),a("a",{attrs:{href:"http://camaradejatai.sigepnet.com.br"}},[e._v("Poder Legislativo")]),e._v(', portanto, os valores se referem a movimentação do dia anterior. Os valores extraídos são sempre os divulgados como "Valor Bruto", não sendo possível atualmente, possuir uma coluna com o "Valor Líquido" por esta, apesar de estar presente nos dados humanamente visíveis, não está nos dados abertos no format CSV. A totalização dos valores pode possuir variações de 1 a 2% com o mostrado nos portais de transparência. Abaixo uma listagem de cada Órgão, com sua última data e último código de despesa extraída. '),a("ul",e._l(e.data_exec,(function(t,s){return a("li",{key:s},[e._v(" "+e._s(t[6])+" - "+e._s(t[5])+" - "+e._s(t[0])+"-"+e._s(t[1])+" ")])})),0)])],1):e._e()])]):e._e(),a("resize-observer",{on:{notify:e.handleResize}})],1)}),[function(){var e=this._self._c;return e("strong",{staticClass:"d-block mx-3 my-2"},[this._v(" Utilize os filtros abaixo e/ou aplique agrupamentos para visões diferentes, "),e("span",{staticClass:"text-danger"},[this._v("o gráfico e tabela serão atualizados automaticamente")]),this._v(". ")])},function(){var e=this._self._c;return e("thead",[e("tr",[e("th",[this._v("Código / Especificação")]),e("th",[this._v("Valor")])])])}],!1,null,"7f2c29ee",null);a.default=c.exports}}]);