{% extends 'crud/form.html' %}
{% load crispy_forms_tags %}
{% load common_cmj_tags %}

{% block base_content %}
<div class="container-search">

  <form method="get" action=".">
    <br>
    <div class="row">
      {% crispy form %}
    </div>
    <div class="row">
      <div class="col-md-5 ">
        <div class="checkbox" id="check_all">
          <input type="checkbox" id="id_check_all" onchange="checkAll(this)" />
          <label for="id_check_all">
            Marcar/Desmarcar Todos
          </label>
        </div>
      </div>
    </div>

      <div class="container-table">
        <div class="result-count">Foram encontrados {{ page.paginator.count }} registros </div>
        
        <table class="table table-striped table-bordered">
        
        {% comment "" %}
        
          <thead class="thead-default">
            <tr><td><h3>Resultados - Foram encontrados {{ page.paginator.count }} registros <br/>
              {% if page.paginator.count %}
              Registros {{ page.start_index }} a {{ page.end_index }} de {{ page.paginator.count }}
              {% endif %}
            </h3></td></tr>
          </thead>
        {% endcomment %}

        {% for result in page.object_list %}
          {% if result.object %}
            <tr>
              <td>

                {% if result.object|search_get_model == 'm' %}

                  <p>
                    <strong>Matéria Legislativa: </strong> <a href="{% url 'sapl.materia:materialegislativa_detail' result.object.pk %}">{{ result.object }}</a>
                    <br>{{result.object.ementa}}
                    <br><strong>Data de Apresentação:</strong> {{result.object.data_apresentacao}}
                    {% if result.object.texto_original %}
                      <br><strong>Texto Original:</strong> <a href="{{result.object.url}}"> Clique aqui </a>
                    {% endif %}
                    {% if result.object.texto_articulado.exists %}
                      <br><strong>Texto Articulado:</strong> <a href="{% url 'sapl.materia:materia_ta' result.object.pk %}"> Clique aqui </a>
                    {% endif %}
                  </p>

                {% elif result.object|search_get_model == 'd' %}
                  <p>
                    <strong>Documento Acessório: </strong><a href="{% url 'sapl.materia:documentoacessorio_detail' result.object.pk %}">{{ result.object }}</a>
                    <br>{{result.object.ementa}}
                    <br><strong>Data:</strong> {{result.object.data}}
                    {% if result.object.arquivo %}
                      <br><strong>Texto Original:</strong> <a href="{{result.object.url}}"> Clique aqui </a>
                    {% endif %}
                  </p>

                {% elif result.object|search_get_model == 'da' %}
                  <p>
                    <strong>Documento Administrativo: </strong><a href="{% url 'sapl.protocoloadm:documentoadministrativo_detail' result.object.pk %}">{{ result.object }}</a>
                    <br>{{result.object.assunto}}
                    <br><strong>Data:</strong> {{result.object.data}}
                    {% if result.object.texto_integral %}
                      <br><strong>Texto Integral:</strong> <a href="{{result.object.url}}"> Clique aqui </a>
                    {% endif %}
                  </p>

                {% elif result.object|search_get_model == 'o' %}
                  <p>
                    <strong>Diário Oficial: </strong><a href="{% url 'cmj.diarios:diariooficial_detail' result.object.pk %}">{{ result.object }}</a>
                    <br>Data: {{result.object.data}}
                    {% comment "" %}
                      <br>{{result.object.descricao}}
                    {% endcomment %}
                    {% if result.object.arquivo %}
                      <br><strong>Arquivo:</strong> <a href="{{result.object.arquivo.url}}"> Clique aqui </a>
                    {% endif %}
                  </p>

                {% elif result.object|search_get_model == 'sd' %}
                  <p>
                    <strong>Notícia: </strong><a href="/{{result.object.absolute_slug}}">{{ result.object }}</a>
                    <br>{{result.object.descricao}}
                    <br><small>Publicado em {{result.object.public_date}}</small>
                  </p>

                {% elif result.object|search_get_model == 'n' %}
                  <p>
                    <strong>Norma Jurídica: </strong><a href="{% url 'sapl.norma:normajuridica_detail' result.object.pk %}">{{ result.object }}</a>
                    <br>{{result.object.ementa}}
                    {% if result.object.texto_integral %}
                    <br><strong>Texto Original:</strong> <a href="{{result.object.texto_integral.url}}"> Clique aqui </a>
                    {% endif %}
                    {% if result.object.texto_articulado %}
                      <br><strong>Texto Articulado:</strong> <a href="{% url 'sapl.norma:norma_ta' result.object.pk %}"> Clique aqui </a>
                    {% endif %}
                  </p>
                {% elif result.object|search_get_model == 'sp' %}
                  <p>
                    <strong>Sessão Planária: </strong><a href="{% url 'sapl.sessao:sessaoplenaria_detail' result.object.pk %}">{{ result.object }}</a>
                    <br>Data: {{result.object.data_inicio}}
                    {% if result.object.upload_ata %}
                      <br><strong>Ata da Sessão:</strong><a href="{{result.object.upload_ata.url}}"> Clique aqui </a>
                    {% endif %}
                  </p>
                {% endif %}
              </td>
            </tr>
          {% endif %}

          {% empty %}
          <tr>
            <td>
              <h3>Nenhum texto encontrado!</h3>
            </td>
          </tr>
          {% endfor %}
        </table>
      </div>
      {% if page.object_list  %}
        {% include "paginacao.html" %}
      {% endif %}

  </form>
</div>
{% endblock %}

{% block extra_js %}

  <script language="JavaScript">
		function checkAll(elem) {
      let checkboxes = document.getElementsByName('models');
      for (let i = 0; i < checkboxes.length; i++) {
        if (checkboxes[i].type == 'checkbox') 
            checkboxes[i].checked = elem.checked; 
      }
    }
  </script>

{% endblock %}